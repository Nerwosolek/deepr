<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<meta content="Deep R Programming" name="citation_title" />
<meta content="Marek Gagolewski" name="citation_author" />
<meta content="2023" name="citation_date" />
<meta content="2023" name="citation_publication_date" />
<meta content="https://deepr.gagolewski.com/deepr.pdf" name="citation_pdf_url" />
<meta content="https://deepr.gagolewski.com" name="citation_public_url" />
<meta content="10.5281/zenodo.7490464" name="citation_doi" />
<meta content="Deep R Programming is comprehensive course on one of the most popular languages in data science (statistical computing, graphics, machine learning, data wrangling and analytics). It introduces the base language in-depth and is aimed at ambitious students, practitioners, and researchers who would like to become independent users of this powerful environment. This textbook is a non-profit project. Its online and PDF versions are freely available at https://deepr.gagolewski.com/." name="citation_abstract" />
<meta content="summary" name="twitter:card" />
<meta content="Deep R Programming" name="twitter:title" />
<meta content="Deep R Programming" name="og:title" />
<meta content="Deep R Programming is comprehensive course on one of the most popular languages in data science (statistical computing, graphics, machine learning, data wrangling and analytics). It introduces the base language in-depth and is aimed at ambitious students, practitioners, and researchers who would like to become independent users of this powerful environment. This textbook is a non-profit project. Its online and PDF versions are freely available at https://deepr.gagolewski.com/." name="twitter:description" />
<meta content="Deep R Programming is comprehensive course on one of the most popular languages in data science (statistical computing, graphics, machine learning, data wrangling and analytics). It introduces the base language in-depth and is aimed at ambitious students, practitioners, and researchers who would like to become independent users of this powerful environment. This textbook is a non-profit project. Its online and PDF versions are freely available at https://deepr.gagolewski.com/." name="og:description" />
<meta content="gagolews/deepr" name="og:site_name" />
<meta content="https://deepr.gagolewski.com" name="og:url" />
<meta content="https://deepr.gagolewski.com/_images/cover.png" name="twitter:image" />
<meta content="https://deepr.gagolewski.com/_images/cover.png" name="og:image" />
<meta content="https://deepr.gagolewski.com" name="DC.identifier" />
<meta content="Marek Gagolewski" name="DC.publisher" />
<meta content="INDEX,FOLLOW" name="robots" />
<meta content="book" name="og:type" />
<meta content="9780645571929" name="og:book:isbn" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="14. 🚧🚧 Interfacing compiled code (*)" href="310-compiled.html" /><link rel="prev" title="12. Data frames" href="240-data-frame.html" />
        <link rel="canonical" href="https://deepr.gagolewski.com/chapter/250-graphics.html" />

    <link rel="shortcut icon" href="../_static/favicon.png"/><!-- Generated with Sphinx 5.3.0 and Furo 2022.12.07 -->
        <title>13. 🚧🚧 Graphics - Deep R Programming</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --admonition-font-size: 95%;
  --admonition-title-font-size: 95%;
  --color-brand-primary: red;
  --color-brand-content: #CC3333;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --admonition-font-size: 95%;
  --admonition-title-font-size: 95%;
  --color-brand-primary: #ff2b53;
  --color-brand-content: #dd3333;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --admonition-font-size: 95%;
  --admonition-title-font-size: 95%;
  --color-brand-primary: #ff2b53;
  --color-brand-content: #dd3333;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Deep R Programming</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto colour theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky">

<span class="sidebar-brand-text">
<a class="sidebar-brand" href="../index.html">Deep R Programming</a>
</span>
<div class="sidebar-brand">
An open-access textbook<br />
by <a href='https://www.gagolewski.com' style="display: contents">Marek Gagolewski</a><br />
v0.2.0.9001 (draft)
</div>
<form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">About</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.gagolewski.com/">Author</a></li>
<li class="toctree-l1"><a class="reference external" href="https://deepr.gagolewski.com/deepr.pdf">This Book in PDF</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/gagolews/deepr/">Report Bugs or Typos (GitHub)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/gagolews/teaching-data">Datasets</a></li>
<li class="toctree-l1"><a class="reference external" href="https://datawranglingpy.gagolewski.com">Data Wrangling with Python</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Start Here</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="000-preface.html">Preface</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Deep</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="110-basics.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="120-numeric.html">2. Numeric vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="130-logical.html">3. Logical vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="140-list.html">4. Lists and attributes</a></li>
<li class="toctree-l1"><a class="reference internal" href="150-indexing.html">5. Vector indexing</a></li>
<li class="toctree-l1"><a class="reference internal" href="160-character.html">6. Character vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="170-function.html">7. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="180-flow.html">8. Flow of execution</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Deeper</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="210-design.html">9. Designing functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="220-s3.html">10. S3 classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="230-matrix.html">11. Matrices and other arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="240-data-frame.html">12. Data frames</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">13. 🚧🚧 Graphics</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Deepest</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="310-compiled.html">14. 🚧🚧 Interfacing compiled code (*)</a></li>
<li class="toctree-l1"><a class="reference internal" href="320-language.html">15. Unevaluated expressions (*)</a></li>
<li class="toctree-l1"><a class="reference internal" href="330-environment.html">16. Environments and evaluation (*)</a></li>
<li class="toctree-l1"><a class="reference internal" href="340-lazy.html">17. Lazy evaluation (**)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="998-changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="999-bibliography.html">References</a></li>
</ul>

</div></div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/gagolews/deepr/issues/" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto colour theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section class="tex2jax_ignore mathjax_ignore" id="graphics">
<span id="chap-graphics"></span><h1><span class="section-number">13. </span>🚧🚧 Graphics<a class="headerlink" href="#graphics" title="Permalink to this heading">#</a></h1>
<blockquote>
<div><p><em>The open-access textbook</em>
Deep R Programming <em>by <a class="reference external" href="https://www.gagolewski.com">Marek Gagolewski</a>
is, and will remain, freely available for everyone’s enjoyment
(also in <a class="reference external" href="https://deepr.gagolewski.com/deepr.pdf">PDF</a>).
It is a non-profit project.</em>
<strong>This book is still a work in progress.</strong> <em>Beta versions
of Chapters 1–12 and 15–17 are already complete (copyediting still pending),
but there will be more. In the meantime,</em> <strong>any
<a class="reference external" href="https://github.com/gagolews/deepr/issues">bug/typos reports/fixes</a>
are appreciated.</strong>
<em>Although available online, it is a whole course;
it should be read from the beginning to the end.
Refer to the <a class="reference internal" href="000-preface.html#chap-preface"><span class="std std-ref">Preface</span></a> for general introductory remarks.</em>
<em>Also, check out my other book,
<a class="reference external" href="https://datawranglingpy.gagolewski.com/"><em>Minimalist Data Wrangling with Python</em></a>
<span id="id1">[<a class="reference internal" href="999-bibliography.html#id3" title="Gagolewski, M. (2022).  Minimalist Data Wrangling with Python. Zenodo, Melbourne. URL: https://datawranglingpy.gagolewski.com/, DOI: 10.5281/zenodo.6451068.">25</a>]</span>.</em></p>
</div></blockquote>
<p>The R Project homepage advertises our free software as an
<em>environment for statistical computing and graphics</em>.
Hence, had we not dealt with the latter use case,
our course would have been incomplete.</p>
<p>R is equipped with the two following independent (incompatible,
yet coexisting) systems for graphics generation;
see <a class="reference internal" href="#fig-graphics-systems"><span class="std std-numref">Figure 13.1</span></a>.</p>
<ol class="arabic simple">
<li><p>The (historically) newer one,
<a class="reference external" href="https://www.stat.auckland.ac.nz/~paul/grid/grid.html"><strong class="program">grid</strong></a>
(e.g., <span id="id2">[<a class="reference internal" href="999-bibliography.html#id42" title="Murrell, P. (2011).  R Graphics. Chapman &amp; Hall/CRC.">44</a>]</span>),
is very flexible but might seem quite complicated.
Some readers might have come across
the <strong class="program">lattice</strong> <span id="id3">[<a class="reference internal" href="999-bibliography.html#id43" title="Sarkar, D. (2008).  Lattice: Multivariate Data Visualization with R. Springer. URL: http://lmdvr.r-forge.r-project.org.">48</a>]</span>
and <strong class="program">ggplot2</strong> <span id="id4">[<a class="reference internal" href="999-bibliography.html#id45" title="Wickham, H. (2016).  ggplot2: Elegant Graphics for Data Analysis. Springer, 2nd edition.">53</a>, <a class="reference internal" href="999-bibliography.html#id44" title="Wilkinson, L. (2005).  The Grammar of Graphics. Springer.">56</a>]</span> packages
before:
they are built on top of <strong class="program">grid</strong>.</p></li>
<li><p>On the other hand, its traditional (S-style) counterpart,
<em>base</em> <strong class="program">graphics</strong> (e.g., <span id="id5">[<a class="reference internal" href="999-bibliography.html#id51" title="Becker, R.A., Chambers, J.M., and Wilks, A.R. (1988).  The New S Language: A Programming Environment for Data Analysis and Graphics. Chapman &amp; Hall.">7</a>]</span>),
is much easier to master.
It still gives their users full control over drawing processes.
Its being simple, fast, and minimalist makes it very attractive
from the perspective of this course’s philosophy.</p></li>
</ol>
<p>This is why we only cover the second system here.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><em>All</em> figures in this book were generated using <strong class="program">graphics</strong>
and its dependants. They are sufficiently aesthetic, aren’t they?</p>
</div>
<figure class="align-default" id="id13">
<span id="fig-graphics-systems"></span><img alt="../_images/graphics-systems.png" src="../_images/graphics-systems.png" />
<figcaption>
<p><span class="caption-number">Figure 13.1 </span><span class="caption-text">Relation between the graphics subsystems</span><a class="headerlink" href="#id13" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<blockquote>
<div><p>🚧 <strong>This chapter is under construction. Please come back later.</strong></p>
</div></blockquote>
<section id="graphics-primitives">
<h2><span class="section-number">13.1. </span>Graphics primitives<a class="headerlink" href="#graphics-primitives" title="Permalink to this heading">#</a></h2>
<p>In <strong class="program">graphics</strong>, we do not choose from a superfluity
of virtual objects to be placed on an abstract canvas,
letting some algorithm decide how and when to delineate them. We <em>just draw</em>.</p>
<p>To do so, we call functions that plot the following <em>graphics primitives</em>
(see, e.g., <span id="id6">[<a class="reference internal" href="999-bibliography.html#id54" title="Hughes, J., van Dam, A., McGuire, M., Sklar, D., Foley, J., Feiner, S., and Akeley, K. (2013).  Computer Graphics: Principles and Practice. Addison-Wesley, 3rd edition.">35</a>, <a class="reference internal" href="999-bibliography.html#id55" title="Marschner, S. and Shirley, P. (2021).  Fundamentals of Computer Graphics. AK Peters/CRC Press, 5th edition.">41</a>]</span>):</p>
<ul class="simple">
<li><p>plotting symbols (e.g., pixels, circles stars)
of different shapes and colours,</p></li>
<li><p>line segments of different styles (e.g., solid, dashed, dotted),</p></li>
<li><p>polygons (optionally filled),</p></li>
<li><p>text (using available fonts),</p></li>
<li><p>raster images (bitmaps; if the output device supports it).</p></li>
</ul>
<p>That’s it. It will turn out that most other shapes
(smooth curves, circles) might be easily approximated using the above.</p>
<div class="proof proof-type-example" id="id14">

    <div class="proof-title">
        <span class="proof-type">Example 13.1</span>
        
    </div><div class="proof-content">
<p><a class="reference internal" href="#fig-primitives-demo"><span class="std std-numref">Figure 13.2</span></a> depicts some
graphics primitives which we plotted using the following program.
We will detail the meaning of all the functions in the next
sections.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">))</span><span class="w">  </span><span class="c1"># small plot margins (bottom, left, top, right)</span>
<span class="nf">plot.new</span><span class="p">()</span><span class="w">  </span><span class="c1"># start a new plot</span>
<span class="nf">plot.window</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">asp</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">  </span><span class="c1"># x range: 0–6, y: 0–2; proportional</span>
<span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w">   </span><span class="m">5</span><span class="p">,</span><span class="w">  </span><span class="m">6</span><span class="p">)</span>
<span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0.25</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<span class="nf">points</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">6</span><span class="p">)],</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">6</span><span class="p">)])</span><span class="w">  </span><span class="c1"># symbols</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w">   </span><span class="c1"># line segments</span>
<span class="nf">text</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;(0, 0)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;(6, 2)&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1"># two text labels</span>
<span class="nf">rasterImage</span><span class="p">(</span>
<span class="w">    </span><span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w">  </span><span class="c1"># 2x3 pixel &quot;image&quot;; 0=black, 1=red</span>
<span class="w">             </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span>
<span class="w">             </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">byrow</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="o">=</span><span class="m">2</span><span class="p">),</span>
<span class="w">    </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w">  </span><span class="c1"># position: xleft, ybottom, xright, ytop</span>
<span class="w">    </span><span class="n">interpolate</span><span class="o">=</span><span class="kc">FALSE</span>
<span class="p">)</span>
<span class="nf">polygon</span><span class="p">(</span>
<span class="w">    </span><span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">5.5</span><span class="p">,</span><span class="w">    </span><span class="m">4</span><span class="p">),</span><span class="w">  </span><span class="c1"># x coordinates of the vertices</span>
<span class="w">    </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w">   </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0.75</span><span class="p">),</span><span class="w">  </span><span class="c1"># y coordinates</span>
<span class="w">    </span><span class="n">lty</span><span class="o">=</span><span class="s">&quot;dotted&quot;</span><span class="p">,</span><span class="w">   </span><span class="c1"># border style</span>
<span class="w">    </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;#ffff0044&quot;</span><span class="w">  </span><span class="c1"># fill colour: semi-transparent yellow</span>
<span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id15">
<span id="fig-primitives-demo"></span><img alt="../_images/primitives-demo-1.png" src="../_images/primitives-demo-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.2 </span><span class="caption-text">Graphical primitives: plotting symbols, line segments, polygons, text labels, and bitmaps; note that objects are plotted one after another, with newer ones overlapping the already existing shapes</span><a class="headerlink" href="#id15" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div><div class="admonition important">
<p class="admonition-title">Important</p>
<p>In <strong class="program">graphics</strong>, most of the function calls have immediate
effects. Objects are drawn on the active plot one by one,
and their state cannot be modified later.</p>
</div>
<p>Of course, in practice, we do not have to be so low-level all the time.
There are many built-in functions that implement (using exactly the above
building blocks) the most popular chart types: histograms, bar plots,
dendrograms, etc. They should suit our basic needs. We will review them
in <a class="reference internal" href="#sec-high-level-plotting"><span class="std std-numref">Section 13.3</span></a>.</p>
<p>The more basic routines that we discuss next will still be useful
for fine-tuning our figures and adding further details.
But, if the prefabricated components are not what we are after,
we will be able to create any drawing from scratch.</p>
<section id="symbols-points">
<h3><span class="section-number">13.1.1. </span>Symbols (points)<a class="headerlink" href="#symbols-points" title="Permalink to this heading">#</a></h3>
<p>The <strong class="command">points</strong> function can be used a draw a series
of plotting symbols (by default, circles) on the two-dimensional
plot region relative to the user coordinate system.</p>
<p>We specify the points’ coordinates using the <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> arguments
(two vectors of equal lengths; no recycling).
Alternatively, we may give a matrix or a data frame with two columns:
the first column (regardless how and if it is named) defines the abscissae
and the second column determines the ordinates.</p>
<p>This function allows each point to be plotted differently, if this
is what we desire. Thus, it is ideal for drawing scatterplots,
possibly for grouped data (see <a class="reference internal" href="#fig-irisplot-factors"><span class="std std-numref">Figure 13.14</span></a> below).
It is vectorised with respect to, amongst others,
the <code class="docutils literal notranslate"><span class="pre">col</span></code> (colour; see <a class="reference internal" href="#sec-colours"><span class="std std-numref">Section 13.2.1</span></a>), <code class="docutils literal notranslate"><span class="pre">cex</span></code> (scale, defaults to 1),
and <code class="docutils literal notranslate"><span class="pre">pch</span></code> (plotting character or symbol, defaults to 1, i.e., a circle)
arguments.</p>
<div class="proof proof-type-example" id="id16">

    <div class="proof-title">
        <span class="proof-type">Example 13.2</span>
        
    </div><div class="proof-content">
<p><a class="reference internal" href="#fig-pch"><span class="std std-numref">Figure 13.3</span></a> gives an overview of the plotting symbols available.
Most often used ones are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">NA_integer_</span></code> – no symbol,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code>, …, <code class="docutils literal notranslate"><span class="pre">14</span></code> and <code class="docutils literal notranslate"><span class="pre">15</span></code>, …, <code class="docutils literal notranslate"><span class="pre">18</span></code> – unfilled and filled symbols,
respectively;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">19</span></code>, …, <code class="docutils literal notranslate"><span class="pre">25</span></code> – filled symbols with a border of width <code class="docutils literal notranslate"><span class="pre">lwd</span></code>;
for codes <code class="docutils literal notranslate"><span class="pre">21</span></code>–<code class="docutils literal notranslate"><span class="pre">25</span></code>, the fill colour is controlled separately
by the <code class="docutils literal notranslate"><span class="pre">bg</span></code> parameter,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;.&quot;</span></code> – a tiny point (a “pixel”),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;a&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code>, etc. – a single character (not all Unicode characters
are available); strings longer than one will be truncated.</p></li>
</ul>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">));</span><span class="w"> </span><span class="nf">plot.new</span><span class="p">();</span><span class="w"> </span><span class="nf">plot.window</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0.9</span><span class="p">,</span><span class="w"> </span><span class="m">9.1</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.9</span><span class="p">,</span><span class="w"> </span><span class="m">4.1</span><span class="p">))</span>
<span class="nf">points</span><span class="p">(</span>
<span class="w">    </span><span class="nf">cbind</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w">  </span><span class="c1"># or x=1:9, y=rep(1, 9)</span>
<span class="w">    </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">pch</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;B&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;b&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Spanish Inquisition&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;!&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;.&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;9&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">xy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">expand.grid</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="o">:</span><span class="m">2</span><span class="p">)</span>
<span class="nf">text</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="m">0</span><span class="o">:</span><span class="p">(</span><span class="nf">nrow</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span><span class="m">-1</span><span class="p">),</span><span class="w"> </span><span class="n">pos</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="o">=</span><span class="m">0.83</span><span class="p">,</span><span class="w"> </span><span class="n">offset</span><span class="o">=</span><span class="m">0.75</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;darkgray&quot;</span><span class="p">)</span>
<span class="nf">points</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">0</span><span class="o">:</span><span class="p">(</span><span class="nf">nrow</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span><span class="m">-1</span><span class="p">),</span><span class="w"> </span><span class="n">bg</span><span class="o">=</span><span class="s">&quot;yellow&quot;</span><span class="p">)</span>
<span class="c1">## Warning in plot.xy(xy.coords(x, y), type = type, ...): unimplemented pch</span>
<span class="c1">##     value &#39;26&#39;</span>
</pre></div>
</div>
<figure class="align-default" id="id17">
<span id="fig-pch"></span><img alt="../_images/pch-1.png" src="../_images/pch-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.3 </span><span class="caption-text">Plotting characters and symbols (<code class="docutils literal notranslate"><span class="pre">pch</span></code>)</span><a class="headerlink" href="#id17" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div></section>
<section id="line-segments">
<h3><span class="section-number">13.1.2. </span>Line segments<a class="headerlink" href="#line-segments" title="Permalink to this heading">#</a></h3>
<p><strong class="command">lines</strong> can be used to draw connected line segments
whose endpoints (midpoints?) are given just like
in the case of the <strong class="command">points</strong> function.
A series of segments can be interrupted by defining an endpoint
whose coordinate  is a missing value; compare <a class="reference internal" href="#fig-primitives-demo"><span class="std std-numref">Figure 13.2</span></a>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">col</span></code> argument controls the line colour (see <a class="reference internal" href="#sec-colours"><span class="std std-numref">Section 13.2.1</span></a>),
<code class="docutils literal notranslate"><span class="pre">lwd</span></code> determines the line width (1 by default), and <code class="docutils literal notranslate"><span class="pre">lty</span></code>
gives the line type.</p>
<p>Six named line types are available, which can also be specified
via their respective numeric IDs, <code class="docutils literal notranslate"><span class="pre">lty=1</span></code>, …, <code class="docutils literal notranslate"><span class="pre">lty=6</span></code>; see <a class="reference internal" href="#fig-lty"><span class="std std-numref">Figure 13.4</span></a>
(implementing a similar plot is left as an exercise).
Additionally, custom dashes can be defined using strings of
up to 8 (hexadecimal) digits. Consecutive digits give the lengths
of the dashes and blanks. For instance, <code class="docutils literal notranslate"><span class="pre">lty=&quot;1343&quot;</span></code> is a dash
of length 1, followed by a space of length 3, then a segment
of length 4, followed by a blank of length 3 (recycled for as long
as necessary).</p>
<figure class="align-default" id="id18">
<span id="fig-lty"></span><img alt="../_images/lty-1.png" src="../_images/lty-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.4 </span><span class="caption-text">Line types (<code class="docutils literal notranslate"><span class="pre">lty</span></code>)</span><a class="headerlink" href="#id18" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><strong class="command">points</strong> and <strong class="command">lines</strong> are wrappers around the same function, <strong class="command">plot.xy</strong> (which we usually do not call directly).
The <code class="docutils literal notranslate"><span class="pre">type</span></code> argument determines the object to draw;
the only difference between them is that
the former uses <code class="docutils literal notranslate"><span class="pre">type=&quot;p&quot;</span></code> whilst the latter relies on <code class="docutils literal notranslate"><span class="pre">type=&quot;l&quot;</span></code> by default.
Changing these to <code class="docutils literal notranslate"><span class="pre">type=&quot;b&quot;</span></code> (both) or <code class="docutils literal notranslate"><span class="pre">type=&quot;o&quot;</span></code> (overplot) will give
their combination. Moreover, <code class="docutils literal notranslate"><span class="pre">type=&quot;s&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">type=&quot;S&quot;</span></code> results in step
functions (with post- and pre-increments, respectively),
and <code class="docutils literal notranslate"><span class="pre">type=&quot;h&quot;</span></code> draws barplot-like vertical lines.
See <a class="reference internal" href="#fig-line-type"><span class="std std-numref">Figure 13.5</span></a> for an illustration
(implement something similar yourself).</p>
<figure class="align-default" id="id19">
<span id="fig-line-type"></span><img alt="../_images/line-type-1.png" src="../_images/line-type-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.5 </span><span class="caption-text">Different <code class="docutils literal notranslate"><span class="pre">type</span></code> argument settings in <strong class="command">lines</strong> or <strong class="command">points</strong></span><a class="headerlink" href="#id19" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="proof proof-type-example" id="id20">

    <div class="proof-title">
        <span class="proof-type">Example 13.3</span>
        
    </div><div class="proof-content">
<p><strong class="command">lines</strong> can be used for plotting empirical cumulative
distribution functions (we will suggest it as an exercise later),
regression models (e.g., lines, splines),
and any other mathematical functions, even if they are smooth and <em>curvy</em>.
This is because a naked eye cannot tell the difference between a densely
sampled piecewise linear approximation of an object to its original version.</p>
<p>The code below illustrates this sad truth using the <em>sine</em>
function; see <a class="reference internal" href="#fig-sampling"><span class="std std-numref">Figure 13.6</span></a>.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">ns</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">seq</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">25</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="o">=</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="m">50</span><span class="p">,</span><span class="w"> </span><span class="m">100</span><span class="p">)</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">));</span><span class="w"> </span><span class="nf">plot.new</span><span class="p">();</span><span class="w"> </span><span class="nf">plot.window</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">*</span><span class="kc">pi</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="nf">seq_along</span><span class="p">(</span><span class="n">ns</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">((</span><span class="n">i</span><span class="m">-1</span><span class="p">)</span><span class="o">*</span><span class="kc">pi</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">*</span><span class="kc">pi</span><span class="p">,</span><span class="w"> </span><span class="n">length.out</span><span class="o">=</span><span class="n">ns</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="w">    </span><span class="nf">lines</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="nf">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="w">    </span><span class="nf">text</span><span class="p">((</span><span class="n">i</span><span class="m">-0.5</span><span class="p">)</span><span class="o">*</span><span class="kc">pi</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">ns</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">cex</span><span class="o">=</span><span class="m">0.83</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<figure class="align-default" id="id21">
<span id="fig-sampling"></span><img alt="../_images/sampling-1.png" src="../_images/sampling-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.6 </span><span class="caption-text">Sampling more densely gives the illusion of smoothness</span><a class="headerlink" href="#id21" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div><div class="proof proof-type-exercise" id="id22">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.4</span>
        
    </div><div class="proof-content">
<p>Implement your own version of the <strong class="command">segments</strong> function,
using a call to <strong class="command">lines</strong>.</p>
</div></div><div class="proof proof-type-exercise" id="id23">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.5</span>
        
    </div><div class="proof-content">
<p>(*) Implement a simplified version of the <strong class="command">arrows</strong> function,
where the length of edges of the arrow head is given in user coordinates
(and not inches; you will be equipped with skills to achieve this
later; see <a class="reference internal" href="#sec-plot-usr"><span class="std std-numref">Section 13.2.4</span></a>).</p>
</div></div></section>
<section id="polygons">
<h3><span class="section-number">13.1.3. </span>Polygons<a class="headerlink" href="#polygons" title="Permalink to this heading">#</a></h3>
<p><strong class="command">polygon</strong> draws a possibly filled (if the <code class="docutils literal notranslate"><span class="pre">col</span></code> argument is not
missing) polygon with a border of specified colour and line type
(<code class="docutils literal notranslate"><span class="pre">border</span></code>, <code class="docutils literal notranslate"><span class="pre">lty</span></code>, <code class="docutils literal notranslate"><span class="pre">lwd</span></code>).</p>
<p>Optionally (<code class="docutils literal notranslate"><span class="pre">density</span></code>, <code class="docutils literal notranslate"><span class="pre">angle</span></code>), instead of filling
with a single colour, the polygon can be hatched.</p>
<div class="proof proof-type-example" id="id24">

    <div class="proof-title">
        <span class="proof-type">Example 13.6</span>
        
    </div><div class="proof-content">
<p>To demo the above function, let us draw a few regular (equilateral
and equiangular) polygons; see <a class="reference internal" href="#fig-circles"><span class="std std-numref">Figure 13.7</span></a>.
By increasing the number of sides, we can obtain an approximation
to a circle.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">regular_poly</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="w"> </span><span class="n">y0</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">101</span><span class="p">,</span><span class="w"> </span><span class="kc">...</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">theta</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="o">*</span><span class="kc">pi</span><span class="p">,</span><span class="w"> </span><span class="n">length.out</span><span class="o">=</span><span class="n">n</span><span class="m">+1</span><span class="p">)[</span><span class="m">-1</span><span class="p">]</span>
<span class="w">    </span><span class="nf">polygon</span><span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">r</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span><span class="w"> </span><span class="n">y0</span><span class="o">+</span><span class="n">r</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span><span class="w"> </span><span class="kc">...</span><span class="p">)</span>
<span class="p">}</span>

<span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">));</span><span class="w"> </span><span class="nf">plot.new</span><span class="p">();</span><span class="w"> </span><span class="nf">plot.window</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">9.5</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">asp</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
<span class="nf">regular_poly</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
<span class="nf">regular_poly</span><span class="p">(</span><span class="m">3.5</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="n">density</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="n">angle</span><span class="o">=</span><span class="m">45</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;tan&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">border</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span>
<span class="nf">regular_poly</span><span class="p">(</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">density</span><span class="o">=</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="n">angle</span><span class="o">=</span><span class="m">-60</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
<span class="nf">regular_poly</span><span class="p">(</span><span class="m">8.5</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">border</span><span class="o">=</span><span class="s">&quot;brown&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;lightyellow&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id25">
<span id="fig-circles"></span><img alt="../_images/circles-1.png" src="../_images/circles-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.7 </span><span class="caption-text">Regular polygons drawn using <strong class="command">polygon</strong></span><a class="headerlink" href="#id25" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Note the <code class="docutils literal notranslate"><span class="pre">asp=1</span></code> argument to the <strong class="command">plot.window</strong> function
(which we detail below) that guarantees the same scaling of the
x- and y-axes. This way, the circle looks like one, and not an oval.</p>
</div></div><p>Note that the last vertex adjoins the first one.
Also, if we are absent-minded (or particularly creative),
we can produce self-intersecting or otherwise degenerate shapes.</p>
<div class="proof proof-type-exercise" id="id26">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.7</span>
        
    </div><div class="proof-content">
<p>Implement your own version of the <strong class="command">rect</strong> function,
using a call to <strong class="command">polygon</strong>.</p>
</div></div></section>
<section id="text">
<h3><span class="section-number">13.1.4. </span>Text<a class="headerlink" href="#text" title="Permalink to this heading">#</a></h3>
<p>A call to <strong class="command">text</strong>, draws arbitrary strings (newlines and tabs
are allowed) centred at, below, to the left of, etc. (see the <code class="docutils literal notranslate"><span class="pre">pos</span></code> argument)
the specified points,
with some further position adjustment possible (<code class="docutils literal notranslate"><span class="pre">adj</span></code>, <code class="docutils literal notranslate"><span class="pre">offset</span></code>);
see <a class="reference internal" href="#fig-textdemo"><span class="std std-numref">Figure 13.8</span></a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">col</span></code> controls the colour, <code class="docutils literal notranslate"><span class="pre">cex</span></code> the size, <code class="docutils literal notranslate"><span class="pre">srt</span></code> the rotation of the text.</p>
<p>On many default graphical devices, we have little control over
the font face used, but see <a class="reference internal" href="#sec-grdevices"><span class="std std-numref">Section 13.2.6</span></a> for some
workarounds.</p>
<figure class="align-default" id="id27">
<span id="fig-textdemo"></span><img alt="../_images/textdemo-1.png" src="../_images/textdemo-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.8 </span><span class="caption-text">The positioning of text with <strong class="command">text</strong> (the plotting symbols were added for reference)</span><a class="headerlink" href="#id27" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>(*) There is some limited support for basic mathematical
symbols and formulae. It relies
on some quirky syntax that we enter using unevaluated R expressions
(<a class="reference internal" href="320-language.html#chap-language"><span class="std std-numref">Chapter 15</span></a>), but it is enough to meet our most basic needs.
For instance, passing “<strong class="command">quote</strong><code class="code docutils literal notranslate"><span class="pre">(beta[i]^j)</span></code>”
as the <code class="docutils literal notranslate"><span class="pre">labels</span></code> argument to <strong class="command">text</strong>, will output “<span class="math notranslate nohighlight">\(\beta_i^j\)</span>”.
See <strong class="command">help</strong><code class="code docutils literal notranslate"><span class="pre">(&quot;plotmath&quot;)</span></code> for more details.</p>
<p>For more sophisticated mathematical typesetting, see <strong class="program">tikzDevice</strong>
that we mention in <a class="reference internal" href="#sec-grdevices"><span class="std std-numref">Section 13.2.6</span></a>.
It renders plot specifications that can be rendered with
the LaTeX typesetting system.</p>
</div>
</section>
<section id="raster-images-bitmaps">
<h3><span class="section-number">13.1.5. </span>Raster images (bitmaps) (*)<a class="headerlink" href="#raster-images-bitmaps" title="Permalink to this heading">#</a></h3>
<p>Most of the output devices also support the drawing of raster
images encoded in the form of bitmaps, i.e., matrices
whose elements represent pixels. Optionally, bilinear interpolation
can be applied if the drawing area is larger than the bitmap size
and we would like to smoothen the colours out.</p>
<p>We will see later that raster images are useful for drawing heatmaps
or backgrounds of contour plots.</p>
<div class="proof proof-type-example" id="id28">

    <div class="proof-title">
        <span class="proof-type">Example 13.8</span>
        
    </div><div class="proof-content">
<p><a class="reference internal" href="#fig-gradient"><span class="std std-numref">Figure 13.9</span></a> presents a very stretched 4-by-3 pixel
image, with and without interpolation.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">));</span><span class="w"> </span><span class="nf">plot.new</span><span class="p">();</span><span class="w"> </span><span class="nf">plot.window</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">9</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span>
<span class="n">I</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">matrix</span><span class="p">(</span><span class="n">nrow</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">byrow</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span>
<span class="w">    </span><span class="nf">c</span><span class="p">(</span><span class="w">   </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;yellow&quot;</span><span class="p">,</span><span class="w">  </span><span class="s">&quot;white&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s">&quot;yellow&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;yellow&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;orange&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s">&quot;yellow&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;orange&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;orange&quot;</span><span class="p">,</span>
<span class="w">       </span><span class="s">&quot;white&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;orange&quot;</span><span class="p">,</span><span class="w">    </span><span class="s">&quot;red&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="nf">rasterImage</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">  </span><span class="c1"># interpolate=TRUE</span>
<span class="nf">rasterImage</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">interpolate</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id29">
<span id="fig-gradient"></span><img alt="../_images/gradient-1.png" src="../_images/gradient-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.9 </span><span class="caption-text">A colour gradient using <strong class="command">rasterImage</strong></span><a class="headerlink" href="#id29" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Another example bitmap is depicted in <a class="reference internal" href="#fig-primitives-demo"><span class="std std-numref">Figure 13.2</span></a>.</p>
</div></div></section>
</section>
<section id="graphics-settings">
<h2><span class="section-number">13.2. </span>🚧 Graphics settings<a class="headerlink" href="#graphics-settings" title="Permalink to this heading">#</a></h2>
<p><strong class="command">par</strong> can be used to read and modify (as long
as they are not read-only) a number of graphics settings.</p>
<p>For instance, we have several parameters related to the current page
or device settings,
e.g., the plot’s margins (see <a class="reference internal" href="#sec-plot-margins"><span class="std std-numref">Section 13.2.2</span></a>)
or user coordinates (see <a class="reference internal" href="#sec-plot-usr"><span class="std std-numref">Section 13.2.4</span></a>).</p>
<p>Moreover, a few functions<a class="footnote-reference brackets" href="#pardefexcept" id="id7" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> may take
the values of some of the parameters set via <strong class="command">par</strong>
as the settings to use by default. This is the case of,
e.g., <code class="docutils literal notranslate"><span class="pre">col</span></code>, <code class="docutils literal notranslate"><span class="pre">pch</span></code>, <code class="docutils literal notranslate"><span class="pre">lty</span></code> in the <strong class="command">plot</strong> and <strong class="command">lines</strong>
function.</p>
<div class="proof proof-type-example" id="id30">

    <div class="proof-title">
        <span class="proof-type">Example 13.9</span>
        
    </div><div class="proof-content">
<p>Execute and study the following code:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1"># uses the default `lty`, i.e., par(&quot;lty&quot;) == &quot;solid&quot;</span>
<span class="n">old_settings</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">par</span><span class="p">(</span><span class="n">lty</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1"># change setting, save old for reference</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1"># uses the default `lty`, i.e., par(&quot;lty&quot;) == &quot;dashed&quot;</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="m">3</span><span class="p">)</span><span class="w">  </span><span class="c1"># uses the given `lty`</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1"># lty=&quot;dashed&quot;</span>
<span class="nf">par</span><span class="p">(</span><span class="n">old_settings</span><span class="p">)</span><span class="w">  </span><span class="c1"># restore previous settings</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1"># lty=&quot;solid&quot;</span>
</pre></div>
</div>
</div></div><p>The reference list of available parameters is given in <strong class="command">help</strong><code class="code docutils literal notranslate"><span class="pre">(&quot;par&quot;)</span></code>.
Below we discuss the most noteworthy ones.</p>
<section id="colours">
<span id="sec-colours"></span><h3><span class="section-number">13.2.1. </span>🚧 Colours<a class="headerlink" href="#colours" title="Permalink to this heading">#</a></h3>
<p>Many functions allow specifying colours of the plotted objects
or their parts, compare, e.g., <code class="docutils literal notranslate"><span class="pre">col</span></code> and <code class="docutils literal notranslate"><span class="pre">border</span></code> arguments
to <strong class="command">polygon</strong>, or <code class="docutils literal notranslate"><span class="pre">col</span></code> and <code class="docutils literal notranslate"><span class="pre">bg</span></code> to <strong class="command">points</strong>.</p>
<p>There are a few ways to specify colours
(see the <em>Colour Specification</em> section in <strong class="command">help</strong><code class="code docutils literal notranslate"><span class="pre">(&quot;par&quot;)</span></code> for more details):</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;colorname&quot;</span></code>, using one of the predefined names known to the
<strong class="command">colours</strong> function:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">sample</span><span class="p">(</span><span class="nf">colours</span><span class="p">(),</span><span class="w"> </span><span class="m">8</span><span class="p">)</span><span class="w">  </span><span class="c1"># this is just a sample</span>
<span></span><span class="c1">## [1] &quot;grey23&quot;        &quot;darksalmon&quot;    &quot;tan3&quot;          &quot;violetred4&quot;</span>
<span class="c1">## [5] &quot;lightblue1&quot;    &quot;darkorchid3&quot;   &quot;darkseagreen1&quot; &quot;slategray3&quot;</span>
</pre></div>
</div>
</li>
<li><p>an <code class="docutils literal notranslate"><span class="pre">&quot;#rrggbb&quot;</span></code> string, giving the position in the
<a class="reference external" href="https://en.wikipedia.org/wiki/RGB_color_model">RGB</a>
colour space; three series of hexadecimal numbers of two digits each,
i.e.,     between <span class="math notranslate nohighlight">\(\text{00}_\text{hex}=0\)</span>
(off) and <span class="math notranslate nohighlight">\(\text{FF}_\text{hex}=255\)</span> (full on),
giving the intensity of the red, green, and blue channels<a class="footnote-reference brackets" href="#footrgb" id="id8" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>;</p>
<p>In practice, <strong class="command">col2rgb</strong> and <strong class="command">rgb</strong> functions
can be used to convert between the decimal and hexadecimal
representations:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;green&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;cyan&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;magenta&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;yellow&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;grey&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;lightgrey&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pink&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1"># example colours</span>
<span class="p">(</span><span class="n">Cmat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">structure</span><span class="p">(</span><span class="nf">col2rgb</span><span class="p">(</span><span class="n">C</span><span class="p">),</span><span class="w"> </span><span class="n">dimnames</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;R&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;G&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;B&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">C</span><span class="p">)))</span>
<span></span><span class="c1">##   black red green blue cyan magenta yellow grey lightgrey pink</span>
<span class="c1">## R     0 255     0    0    0     255    255  190       211  255</span>
<span class="c1">## G     0   0   255    0  255       0    255  190       211  192</span>
<span class="c1">## B     0   0     0  255  255     255      0  190       211  203</span>
<span></span><span class="nf">structure</span><span class="p">(</span><span class="nf">rgb</span><span class="p">(</span><span class="n">Cmat</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="p">],</span><span class="w"> </span><span class="n">Cmat</span><span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="p">],</span><span class="w"> </span><span class="n">Cmat</span><span class="p">[</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="p">],</span><span class="w"> </span><span class="n">maxColorValue</span><span class="o">=</span><span class="m">255</span><span class="p">),</span>
<span class="w">    </span><span class="n">names</span><span class="o">=</span><span class="n">C</span><span class="p">)</span>
<span></span><span class="c1">##     black       red     green      blue      cyan   magenta    yellow</span>
<span class="c1">## &quot;#000000&quot; &quot;#FF0000&quot; &quot;#00FF00&quot; &quot;#0000FF&quot; &quot;#00FFFF&quot; &quot;#FF00FF&quot; &quot;#FFFF00&quot;</span>
<span class="c1">##      grey lightgrey      pink</span>
<span class="c1">## &quot;#BEBEBE&quot; &quot;#D3D3D3&quot; &quot;#FFC0CB&quot;</span>
</pre></div>
</div>
</li>
<li><p>an <code class="docutils literal notranslate"><span class="pre">&quot;#rrggbbaa&quot;</span></code> string, like above, but with the added alpha channel
(two additional hexadecimal digits): from <span class="math notranslate nohighlight">\(\text{00}_\text{hex}=0\)</span>
denoting fully transparent, to <span class="math notranslate nohighlight">\(\text{FF}_\text{hex}=255\)</span>
indicating fully visible (“lit”) colour;
see <a class="reference internal" href="#fig-primitives-demo"><span class="std std-numref">Figure 13.2</span></a> for an example;</p></li>
<li><p>an integer index, selecting an item from the <em>current palette</em>
(with recycling), which we can get or set by a call to
<strong class="command">palette</strong>.</p>
<p>Moreover, <code class="docutils literal notranslate"><span class="pre">0</span></code> identifies the background colour,
<strong class="command">par</strong><code class="code docutils literal notranslate"><span class="pre">(&quot;bg&quot;)</span></code>.</p>
</li>
</ul>
<div class="proof proof-type-example" id="id31">

    <div class="proof-title">
        <span class="proof-type">Example 13.10</span>
        
    </div><div class="proof-content">
<p>It is worth to memorise the colours in the default palette:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">palette</span><span class="p">()</span><span class="w">  </span><span class="c1"># default palette</span>
<span class="c1">## [1] &quot;#000000F0&quot; &quot;#DF536BF0&quot; &quot;#61D04FF0&quot; &quot;#2297E6F0&quot; &quot;#28E2E5F0&quot;</span>
<span class="c1">## [6] &quot;#CD0BBCF0&quot; &quot;#F5C710F0&quot; &quot;#999999F0&quot;</span>
</pre></div>
</div>
<p>These are<a class="footnote-reference brackets" href="#footcolourblind" id="id9" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>, in order: black, red, green, blue, cyan, magenta, yellow, grey; see <a class="reference internal" href="#fig-palette"><span class="std std-numref">Figure 13.10</span></a> for an illustration.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">k</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="nf">palette</span><span class="p">())</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">));</span><span class="w"> </span><span class="nf">plot.new</span><span class="p">();</span><span class="w"> </span><span class="nf">plot.window</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="m">+1</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span>
<span class="nf">points</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
<span class="nf">text</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="nf">palette</span><span class="p">(),</span><span class="w"> </span><span class="n">pos</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="n">length.out</span><span class="o">=</span><span class="n">k</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">offset</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
<span class="nf">text</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">length.out</span><span class="o">=</span><span class="n">k</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">offset</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id32">
<span id="fig-palette"></span><img alt="../_images/palette-1.png" src="../_images/palette-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.10 </span><span class="caption-text">The default <strong class="command">palette</strong></span><a class="headerlink" href="#id32" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Integer colour specifiers are particularly useful when plotting
data in groups, as defined by factors: the underlying integer level codes
can be mapped to consecutive colours from the above list;
see  <a class="reference internal" href="#fig-irisplot-factors"><span class="std std-numref">Figure 13.14</span></a> below for an example.</p>
</div></div><p>As choosing usable colours requires some talents that most
programmers do not have, we will find ourselves relying
on some built-in, good-enough, colour sets.
<strong class="command">palette.pals</strong> and <strong class="command">hcl.pals</strong>
returns the names of available <em>discrete</em>
palettes. Then, <strong class="command">palette.colors</strong> and <strong class="command">hcl.colors</strong>
can generate a given number of colours from a named set
from the respective list.</p>
<p>There are also <em>continuous</em> palettes available,
see <strong class="command">rainbow</strong>, <strong class="command">heat.colors</strong>,
<strong class="command">terrain.colors</strong>, <strong class="command">topo.colors</strong>,
<strong class="command">cm.colors</strong>, and <strong class="command">gray.colors</strong>
(note the American spelling). They smoothly transition
between some predefined pivot colours, e.g.,
from blue through green to brown (like in a topographic map
with elevation colouring).
They may be useful when drawing, for instance, contour plots;
compare <code class="xref std std-numref docutils literal notranslate"><span class="pre">fig:contour</span></code>.</p>
</section>
<section id="plot-margins">
<span id="sec-plot-margins"></span><h3><span class="section-number">13.2.2. </span>🚧 Plot margins<a class="headerlink" href="#plot-margins" title="Permalink to this heading">#</a></h3>
<p>… working on it …</p>
<div class="proof proof-type-example" id="id33">

    <div class="proof-title">
        <span class="proof-type">Example 13.11</span>
        
    </div><div class="proof-content">
<p><a class="reference internal" href="#fig-margins1"><span class="std std-numref">Figure 13.11</span></a>…</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot.new</span><span class="p">()</span>
<span class="nf">plot.window</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">-2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w">  </span><span class="c1"># whatever</span>

<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1"># Some text lines on the inner margins</span>
<span class="w">    </span><span class="nf">for </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="nf">seq_len</span><span class="p">(</span><span class="nf">par</span><span class="p">(</span><span class="s">&quot;mar&quot;</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span><span class="m">-1</span><span class="p">))</span>
<span class="w">        </span><span class="nf">mtext</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;Text line %d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">),</span><span class="w"> </span><span class="n">side</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="n">j</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;lightgray&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">mtext</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;Inner margin %d (mar[%d]=%g)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="nf">par</span><span class="p">(</span><span class="s">&quot;mar&quot;</span><span class="p">)[</span><span class="n">i</span><span class="p">]),</span>
<span class="w">            </span><span class="n">side</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;darkgray&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="nf">rect</span><span class="p">(</span><span class="m">-10</span><span class="p">,</span><span class="w"> </span><span class="m">-10</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;lightgray&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1"># rectangle (clipped to plot region)</span>
<span class="nf">text</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Plot region&quot;</span><span class="p">)</span>

<span class="nf">box</span><span class="p">(</span><span class="s">&quot;figure&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1"># a box around the figure region</span>
<span class="nf">box</span><span class="p">(</span><span class="s">&quot;plot&quot;</span><span class="p">)</span><span class="w">   </span><span class="c1"># a box around the plot region</span>
<span class="nf">axis</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="w">  </span><span class="c1"># horizontal axis (bottom)</span>
<span class="nf">axis</span><span class="p">(</span><span class="m">2</span><span class="p">)</span><span class="w">  </span><span class="c1"># vertical axis (left)</span>
</pre></div>
</div>
<figure class="align-default" id="id34">
<span id="fig-margins1"></span><img alt="../_images/margins1-1.png" src="../_images/margins1-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.11 </span><span class="caption-text">Figure layout with default inner (5.1, 4.1, 4.1, 2.1 text lines) and outer (all 0) margins: some tweaking might be necessary to better suit our needs</span><a class="headerlink" href="#id34" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div></section>
<section id="clipping-regions">
<h3><span class="section-number">13.2.3. </span>🚧 Clipping regions<a class="headerlink" href="#clipping-regions" title="Permalink to this heading">#</a></h3>
<p>… working on it …</p>
<p>xpd = FALSE - clipping to the plot region</p>
<p>xpd = TRUE - figure region</p>
<p>xpd = NA - device region</p>
<p>also graphics::clip sets a rectangular clipping region</p>
</section>
<section id="user-coordinates-and-plot-dimensions">
<span id="sec-plot-usr"></span><h3><span class="section-number">13.2.4. </span>🚧 User coordinates and plot dimensions<a class="headerlink" href="#user-coordinates-and-plot-dimensions" title="Permalink to this heading">#</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>1 inch (1”) is exactly 25.4 mm.</p>
</div>
<p>… working on it …</p>
<p>in inches:</p>
<p>pin - plot dimensions (width, height)</p>
<p>fin - figure region dimensions</p>
<p>din - page (device) dimensions</p>
<p>mai - plot (inner) margin size</p>
<p>omi - outer margins</p>
<p>cin - size of “default” character  (width, height)</p>
<p>Note that if the figure is scaled, the <em>virtual</em> inch
(the one reported by R) will not match the physical one
(e.g., the actual size in the printed version of this book
or on the computer screen).</p>
<p>par(“din”)
par(“fin”)  # same as din of outer margins (omi) are all 0</p>
<p>par(“pin”)</p>
<p>par(“omi”=c(0.5, 0.5, 0.5, 0.5))
par(“mai”)</p>
<p>par(“fin”)[1]
par(“din”)[1] - par(“omi”)[2] - par(“omi”)[4]
par(“fin”)[2]
par(“din”)[2] - par(“omi”)[1] - par(“omi”)[3]</p>
<p>par(“pin”)[1]
par(“fin”)[1] - par(“mai”)[2] - par(“mai”)[4]
par(“pin”)[2]
par(“fin”)[2] - par(“mai”)[1] - par(“mai”)[3]</p>
<p>also:</p>
<p><code class="docutils literal notranslate"><span class="pre">usr</span></code> gives the extremes of the user coordinates (x1, x2, y1, y2)</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot.new</span><span class="p">()</span>
<span class="nf">plot.window</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">asp</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
<span class="nf">par</span><span class="p">(</span><span class="s">&quot;usr&quot;</span><span class="p">)</span>
<span class="c1">## [1] -2.111  2.111 -1.080  1.080</span>
</pre></div>
</div>
<p>but for xlog <code class="docutils literal notranslate"><span class="pre">10^par(&quot;usr&quot;)[1:2]</span></code></p>
<p>and for ylog <code class="docutils literal notranslate"><span class="pre">10^par(&quot;usr&quot;)[3:4]</span></code></p>
<p>xaxs, yaxs</p>
<p>We always plot in user coordinates!
par(“usr”) is mapped to the page (+ clipping)</p>
<p>units: inches, default character height</p>
<p>xinch = …
yinch = …</p>
<p><a class="reference internal" href="#fig-user-coords"><span class="std std-numref">Figure 13.12</span></a>…</p>
<figure class="align-default" id="id35">
<span id="fig-user-coords"></span><img alt="../_images/user-coords-1.png" src="../_images/user-coords-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.12 </span><span class="caption-text">User vs device coordinates</span><a class="headerlink" href="#id35" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>… to do …
Example: <strong class="command">mtext</strong> ignores the <code class="docutils literal notranslate"><span class="pre">srt</span></code> setting,
so text on the right margin
cannot be rotated freely; but we can do it manually with <strong class="command">text</strong>.</p>
</section>
<section id="many-figures-on-one-page-subplots">
<h3><span class="section-number">13.2.5. </span>🚧 Many figures on one page (subplots)<a class="headerlink" href="#many-figures-on-one-page-subplots" title="Permalink to this heading">#</a></h3>
<p>… working on it …</p>
<p><a class="reference internal" href="#fig-margins2"><span class="std std-numref">Figure 13.13</span></a>…</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">par</span><span class="p">(</span><span class="n">oma</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">1.1</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">))</span><span class="w">  </span><span class="c1"># outer margins (default 0)</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">))</span><span class="w">  </span><span class="c1"># a 2x2 plot grid</span>

<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">plot.new</span><span class="p">()</span>
<span class="w">    </span><span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">))</span>
<span class="w">    </span><span class="nf">plot.window</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span>

<span class="w">    </span><span class="nf">rect</span><span class="p">(</span><span class="m">-10</span><span class="p">,</span><span class="w"> </span><span class="m">-10</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;lightgray&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">text</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;Plot region (plot %d)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">))</span>

<span class="w">    </span><span class="nf">box</span><span class="p">(</span><span class="s">&quot;figure&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1"># a box around the figure region</span>
<span class="w">    </span><span class="nf">box</span><span class="p">(</span><span class="s">&quot;plot&quot;</span><span class="p">)</span><span class="w">   </span><span class="c1"># a box around the plot region</span>
<span class="w">    </span><span class="nf">axis</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="w">  </span><span class="c1"># horizontal axis (bottom)</span>
<span class="w">    </span><span class="nf">axis</span><span class="p">(</span><span class="m">2</span><span class="p">)</span><span class="w">  </span><span class="c1"># vertical axis (left)</span>
<span class="p">}</span>

<span class="nf">box</span><span class="p">(</span><span class="s">&quot;outer&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="s">&quot;dotdash&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1"># a box around the whole page</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">)</span>
<span class="w">    </span><span class="nf">mtext</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;Outer margin %d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">side</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">outer</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id36">
<span id="fig-margins2"></span><img alt="../_images/margins2-1.png" src="../_images/margins2-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.13 </span><span class="caption-text">A page with four figures</span><a class="headerlink" href="#id36" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>also: <strong class="command">layout</strong> (incompatible with <code class="docutils literal notranslate"><span class="pre">mfrow</span></code> and <code class="docutils literal notranslate"><span class="pre">mfcol</span></code>);
examples:
scatterplot with marginal histograms,
trellis plot+subgroups+legend on the side (3 factor comb)</p>
</section>
<section id="graphics-devices">
<span id="sec-grdevices"></span><h3><span class="section-number">13.2.6. </span>🚧 Graphics devices<a class="headerlink" href="#graphics-devices" title="Permalink to this heading">#</a></h3>
<p>… working on it …</p>
</section>
</section>
<section id="higher-level-functions">
<span id="sec-high-level-plotting"></span><h2><span class="section-number">13.3. </span>🚧 Higher-level functions<a class="headerlink" href="#higher-level-functions" title="Permalink to this heading">#</a></h2>
<p>… working on it …</p>
</section>
<section id="placeholders-for-plots-referred-to-elsewhere">
<h2><span class="section-number">13.4. </span>🚧 Placeholders for plots referred to elsewhere<a class="headerlink" href="#placeholders-for-plots-referred-to-elsewhere" title="Permalink to this heading">#</a></h2>
<p>… to do … working on it …</p>
<p>🚧 Plotting and factors; see <a class="reference internal" href="#fig-irisplot-factors"><span class="std std-numref">Figure 13.14</span></a>.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span>
<span class="w">    </span><span class="n">iris</span><span class="p">[[</span><span class="s">&quot;Sepal.Length&quot;</span><span class="p">]],</span><span class="w">  </span><span class="c1"># x (it is a numeric vector)</span>
<span class="w">    </span><span class="n">iris</span><span class="p">[[</span><span class="s">&quot;Petal.Width&quot;</span><span class="p">]],</span><span class="w">   </span><span class="c1"># y (it is a numeric vector)</span>
<span class="w">    </span><span class="n">col</span><span class="o">=</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">iris</span><span class="p">[[</span><span class="s">&quot;Species&quot;</span><span class="p">]]),</span><span class="w">  </span><span class="c1"># colours (integer codes)</span>
<span class="w">    </span><span class="n">pch</span><span class="o">=</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">iris</span><span class="p">[[</span><span class="s">&quot;Species&quot;</span><span class="p">]]),</span><span class="w">  </span><span class="c1"># plotting symbols (integer codes)</span>
<span class="w">    </span><span class="n">xlab</span><span class="o">=</span><span class="s">&quot;Sepal length&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">ylab</span><span class="o">=</span><span class="s">&quot;Petal width&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">asp</span><span class="o">=</span><span class="m">1</span><span class="w">  </span><span class="c1"># y/x aspect ratio</span>
<span class="p">)</span>
<span class="nf">legend</span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;bottomright&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">legend</span><span class="o">=</span><span class="nf">levels</span><span class="p">(</span><span class="n">iris</span><span class="p">[[</span><span class="s">&quot;Species&quot;</span><span class="p">]]),</span>
<span class="w">    </span><span class="n">col</span><span class="o">=</span><span class="nf">seq_along</span><span class="p">(</span><span class="nf">levels</span><span class="p">(</span><span class="n">iris</span><span class="p">[[</span><span class="s">&quot;Species&quot;</span><span class="p">]])),</span>
<span class="w">    </span><span class="n">pch</span><span class="o">=</span><span class="nf">seq_along</span><span class="p">(</span><span class="nf">levels</span><span class="p">(</span><span class="n">iris</span><span class="p">[[</span><span class="s">&quot;Species&quot;</span><span class="p">]])),</span>
<span class="w">    </span><span class="n">bg</span><span class="o">=</span><span class="s">&quot;white&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id37">
<span id="fig-irisplot-factors"></span><img alt="../_images/irisplot-factors-1.png" src="../_images/irisplot-factors-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.14 </span><span class="caption-text"><strong class="command">as.numeric</strong> on factors can be used to define different plotting styles for each factor level</span><a class="headerlink" href="#id37" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="exercises">
<h2><span class="section-number">13.5. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h2>
<div class="proof proof-type-exercise" id="id38">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.12</span>
        
    </div><div class="proof-content">
<p>Answer the following questions:</p>
<ul class="simple">
<li><p>Can functions from the <strong class="program">graphics</strong> package be used to adjust
the plots generated by <strong class="program">lattice</strong> and <strong class="program">ggplot2</strong>?</p></li>
<li><p>What are the admissible values of <code class="docutils literal notranslate"><span class="pre">pch</span></code> and <code class="docutils literal notranslate"><span class="pre">lty</span></code>?
Also, in the default palette, what is the meaning of colours
<code class="docutils literal notranslate"><span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">2</span></code>, …, <code class="docutils literal notranslate"><span class="pre">8</span></code>?
(It is good to learn them by heart.)</p></li>
<li><p>…</p></li>
</ul>
</div></div><div style="margin-top: 1em"></div><p>For further information on graphics generation in R,
see, e.g., Chapter 12 in <span id="id10">[<a class="reference internal" href="999-bibliography.html#id8" title="Venables, W.N., Smith, D.M., and R Development Core Team. (2023).  An Introduction to R. URL: https://CRAN.R-project.org/doc/manuals/r-release/R-intro.html.">52</a>]</span>, <span id="id11">[<a class="reference internal" href="999-bibliography.html#id42" title="Murrell, P. (2011).  R Graphics. Chapman &amp; Hall/CRC.">44</a>]</span>,
and <span id="id12">[<a class="reference internal" href="999-bibliography.html#id52" title="Rahlf, T. (2019).  Data Visualisation with R: 111 Examples. Springer Nature, 2nd edition. URL: http://www.datavisualisation-r.com/.">47</a>]</span>.</p>
<p>Note that in this chapter, we were only interested in <em>static</em> graphics
generation, e.g., for use in printed publications or plain websites.
Interactive plots that a user might tinker with in a web browser
are a different story.</p>
<p>And so the second part of our course is ended.</p>
<blockquote>
<div><p>🚧 <strong>This chapter is under construction. Please come back later.</strong></p>
</div></blockquote>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="pardefexcept" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id7">1</a><span class="fn-bracket">]</span></span>
<p>Unfortunately, it is not as straightforward as that.
For instance, <strong class="command">polygon</strong> is not affected by the <code class="docutils literal notranslate"><span class="pre">col</span></code> setting,
<strong class="command">axis</strong> uses <code class="docutils literal notranslate"><span class="pre">col.axis</span></code> instead, etc.
We should always consult the documentation.</p>
</aside>
<aside class="footnote brackets" id="footrgb" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id8">2</a><span class="fn-bracket">]</span></span>
<p>Note that unlike the subtractive CMYK model which we
know from printers (and school, think: crayons), the RGB model
is additive, hence less intuitive; total darkness emerges when
we do not emit any light; yellow emerges when mixing
red and green beams, etc.</p>
</aside>
<aside class="footnote brackets" id="footcolourblind" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id9">3</a><span class="fn-bracket">]</span></span>
<p>Actually, red-ish, green-ish, etc.
The choice is not only more aesthetic than when pure red/green/…
was used (before R 4.0.0),
but also should be more friendly to people who have
some colour vision deficiencies
(ca. every 1 in 12 men (8%) and 1 in 200 women (0.5%),
especially in the red-green or blue-yellow spectrum).</p>
</aside>
</aside>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="310-compiled.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><span class="section-number">14. </span>🚧🚧 Interfacing compiled code (*)</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="240-data-frame.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><span class="section-number">12. </span>Data frames</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
              
              
              Copyright &#169; 2022–2023 by <a href="https://www.gagolewski.com">Marek Gagolewski</a>.
              Some rights reserved. Licensed under <a href='https://creativecommons.org/licenses/by-nc-nd/4.0/'>CC BY-NC-ND 4.0</a>.
              Built with <a href="https://sphinx-doc.org/">Sphinx</a>
              and a customised <a href="https://github.com/pradyunsg/furo">Furo</a> theme.
              Last updated on 2023-04-20T17:48:09+1000.
              This site will never display any ads: it is a non-profit project.
              It does not collect any data.
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            In this chapter
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">13. 🚧🚧 Graphics</a><ul>
<li><a class="reference internal" href="#graphics-primitives">13.1. Graphics primitives</a><ul>
<li><a class="reference internal" href="#symbols-points">13.1.1. Symbols (points)</a></li>
<li><a class="reference internal" href="#line-segments">13.1.2. Line segments</a></li>
<li><a class="reference internal" href="#polygons">13.1.3. Polygons</a></li>
<li><a class="reference internal" href="#text">13.1.4. Text</a></li>
<li><a class="reference internal" href="#raster-images-bitmaps">13.1.5. Raster images (bitmaps) (*)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#graphics-settings">13.2. 🚧 Graphics settings</a><ul>
<li><a class="reference internal" href="#colours">13.2.1. 🚧 Colours</a></li>
<li><a class="reference internal" href="#plot-margins">13.2.2. 🚧 Plot margins</a></li>
<li><a class="reference internal" href="#clipping-regions">13.2.3. 🚧 Clipping regions</a></li>
<li><a class="reference internal" href="#user-coordinates-and-plot-dimensions">13.2.4. 🚧 User coordinates and plot dimensions</a></li>
<li><a class="reference internal" href="#many-figures-on-one-page-subplots">13.2.5. 🚧 Many figures on one page (subplots)</a></li>
<li><a class="reference internal" href="#graphics-devices">13.2.6. 🚧 Graphics devices</a></li>
</ul>
</li>
<li><a class="reference internal" href="#higher-level-functions">13.3. 🚧 Higher-level functions</a></li>
<li><a class="reference internal" href="#placeholders-for-plots-referred-to-elsewhere">13.4. 🚧 Placeholders for plots referred to elsewhere</a></li>
<li><a class="reference internal" href="#exercises">13.5. Exercises</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/proof.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>