<!DOCTYPE html>


<html class="writer-html5" lang="en" >
<!-- Copyright (C) 2020-2022, Marek Gagolewski <https://www.gagolewski.com> -->

<head>
  <meta charset="utf-8" />

  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta content="Deep R Programming" name="citation_title" />
<meta content="Marek Gagolewski" name="citation_author" />
<meta content="2023" name="citation_date" />
<meta content="2023" name="citation_publication_date" />
<meta content="https://deepr.gagolewski.com/deepr.pdf" name="citation_pdf_url" />
<meta content="https://deepr.gagolewski.com/" name="citation_public_url" />
<meta content="10.5281/zenodo.7490464" name="citation_doi" />
<meta content="Deep R Programming is comprehensive course on one of the most popular languages in data science (statistical computing, graphics, machine learning, data wrangling and analytics). It introduces the base language in-depth and is aimed at ambitious students, practitioners, and researchers who would like to become independent users of this powerful environment. This textbook is a non-profit project. Its online and PDF versions are freely available at https://deepr.gagolewski.com/." name="citation_abstract" />
<meta content="summary" name="twitter:card" />
<meta content="Deep R Programming" name="twitter:title" />
<meta content="Deep R Programming" name="og:title" />
<meta content="Deep R Programming is comprehensive course on one of the most popular languages in data science (statistical computing, graphics, machine learning, data wrangling and analytics). It introduces the base language in-depth and is aimed at ambitious students, practitioners, and researchers who would like to become independent users of this powerful environment. This textbook is a non-profit project. Its online and PDF versions are freely available at https://deepr.gagolewski.com/." name="twitter:description" />
<meta content="Deep R Programming is comprehensive course on one of the most popular languages in data science (statistical computing, graphics, machine learning, data wrangling and analytics). It introduces the base language in-depth and is aimed at ambitious students, practitioners, and researchers who would like to become independent users of this powerful environment. This textbook is a non-profit project. Its online and PDF versions are freely available at https://deepr.gagolewski.com/." name="og:description" />
<meta content="gagolews/deepr" name="og:site_name" />
<meta content="https://deepr.gagolewski.com/" name="og:url" />
<meta content="https://deepr.gagolewski.com/_images/cover.png" name="twitter:image" />
<meta content="https://deepr.gagolewski.com/_images/cover.png" name="og:image" />
<meta content="https://deepr.gagolewski.com/" name="DC.identifier" />
<meta content="Marek Gagolewski" name="DC.publisher" />
<meta content="INDEX,FOLLOW" name="robots" />
<meta content="book" name="og:type" />
<meta content="9780645571929" name="og:book:isbn" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>5. Vector Indexing &mdash; Deep R Programming by Marek Gagolewski</title>
  

  
  
  <script async defer src="https://buttons.github.io/buttons.js"></script>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/proof.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.png"/>
  

  
  

  
    <link rel="canonical" href="https://deepr.gagolewski.com/chapter/150-indexing.html" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/proof.js"></script>
        <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. Character Vectors" href="160-character.html" />
    <link rel="prev" title="4. Lists and Attributes" href="140-list.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html"> Deep R Programming
          

          
          </a>

          <div class="version">
          An Open-Access Textbook<br />    by <a style="color: inherit" href="https://www.gagolewski.com">Marek     Gagolewski</a><br />    v0.1.12.9001 (draft)
          </div>

<!--
          
            
            
              <div class="version">
                by Marek Gagolewski
              </div>
            
          
-->

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search phrase..." />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">About</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.gagolewski.com/">Author</a></li>
<li class="toctree-l1"><a class="reference external" href="https://deepr.gagolewski.com/deepr.pdf">This Book in PDF</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/gagolews/deepr/">Report Bugs or Typos (GitHub)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/gagolews/teaching-data">Datasets</a></li>
<li class="toctree-l1"><a class="reference external" href="https://datawranglingpy.gagolewski.com">Data Wrangling with Python</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Start Here</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="000-preface.html">Preface</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Deep</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="110-basics.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="120-numeric.html">2. Numeric Vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="130-logical.html">3. Logical Vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="140-list.html">4. Lists and Attributes</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">5. Vector Indexing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#head-and-tail">5.1. <strong class="command">head</strong> and <strong class="command">tail</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#subsetting-of-and-extracting-from-vectors">5.2. Subsetting of and Extracting from Vectors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nonnegative-indexes">5.2.1. Nonnegative Indexes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#negative-indexes">5.2.2. Negative Indexes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#logical-indexer">5.2.3. Logical Indexer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#character-indexer">5.2.4. Character Indexer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#replacing-elements">5.3. Replacing Elements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#modifying-atomic-vectors">5.3.1. Modifying Atomic Vectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#modifying-lists">5.3.2. Modifying Lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inserting-new-elements">5.3.3. Inserting New Elements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#functions-related-to-indexing">5.4. Functions Related to Indexing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#matching-of-elements-in-another-vector">5.4.1. Matching of Elements in Another Vector</a></li>
<li class="toctree-l3"><a class="reference internal" href="#assigning-numbers-into-intervals">5.4.2. Assigning Numbers into Intervals</a></li>
<li class="toctree-l3"><a class="reference internal" href="#splitting-vectors-into-subgroups">5.4.3. Splitting Vectors into Subgroups</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ordering-elements">5.4.4. Ordering Elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#identifying-duplicates">5.4.5. Identifying Duplicates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#counting-index-occurrences">5.4.6. Counting Index Occurrences</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#preserving-and-losing-attributes">5.5. Preserving and Losing Attributes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#c">5.5.1. <strong class="command">c</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#as-something">5.5.2. <strong class="command">as.something</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#subsetting">5.5.3. Subsetting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vectorised-functions">5.5.4. Vectorised Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#exercises">5.6. Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="160-character.html">6. Character Vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="170-function.html">7. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="180-flow.html">8. Flow of Execution</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Deeper</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="210-design.html">9. Designing Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="220-s3.html">10. S3 Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="230-matrix.html">11. Matrices and Other Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="240-data-frame.html">12. Data Frames</a></li>
<li class="toctree-l1"><a class="reference internal" href="250-graphics.html">13. 🚧 Graphics</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Deepest</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="310-compile.html">14. 🚧 Interfacing Compiled Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="320-language.html">15. 🚧 Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="330-environment.html">16. 🚧 Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="340-eval-expr.html">17. 🚧 Evaluating Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="350-eval-fun.html">18. 🚧 Evaluating Functions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="998-changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="999-bibliography.html">References</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Deep R Programming</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          



















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li><span class="section-number">5. </span>Vector Indexing</li>
    
    
      <li class="wy-breadcrumbs-aside">

        
        
        <a class="github-button" href="https://github.com/gagolews/deepr" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star gagolews/deepr on GitHub">GitHub</a>
        


        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="160-character.html" class="btn btn-neutral float-right" title="6. Character Vectors" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
      
      
        <a href="140-list.html" class="btn btn-neutral float-left" title="4. Lists and Attributes" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section class="tex2jax_ignore mathjax_ignore" id="vector-indexing">
<span id="chap-indexing"></span><h1><span class="section-number">5. </span>Vector Indexing<a class="headerlink" href="#vector-indexing" title="Permalink to this heading"></a></h1>
<blockquote>
<div><p><em>The open-access textbook</em>
Deep R Programming <em>by <a class="reference external" href="https://www.gagolewski.com">Marek Gagolewski</a>
is, and will remain, freely available for everyone’s enjoyment
(also in <a class="reference external" href="https://deepr.gagolewski.com/deepr.pdf">PDF</a>).
It is a non-profit project.</em>
<strong>This book is still a work in progress. Beta versions
of Chapters 1–12 are already complete, but there will be more.
In the meantime, any
<a class="reference external" href="https://github.com/gagolews/deepr/issues">bug/typos reports/fixes</a>
are appreciated.</strong>
<em>Although available online, it is a whole course;
it should be read from the beginning to the end.
Refer to the <a class="reference internal" href="000-preface.html#chap-preface"><span class="std std-ref">Preface</span></a> for general introductory remarks.</em>
<em>Also, check out my other book, <a class="reference external" href="https://datawranglingpy.gagolewski.com/"><em>Minimalist Data Wrangling with Python</em></a> <span id="id1">[<a class="reference internal" href="999-bibliography.html#id3" title="Gagolewski, M. (2022).  Minimalist Data Wrangling with Python. Zenodo, Melbourne. ISBN 978-0-6455719-1-2. URL: https://datawranglingpy.gagolewski.com/, DOI: 10.5281/zenodo.6451068.">20</a>]</span>.</em></p>
</div></blockquote>
<p>We now know plenty of ways to process vectors <em>in their entirety</em>,
but how to extract and replace specific <em>parts</em> thereof? We will be
referring to such activities collectively as <em>indexing</em>, because
they are often performed through the <em>index operator</em>, `<strong class="command">[</strong>`.</p>
<section id="head-and-tail">
<span id="sec-head-tail"></span><h2><span class="section-number">5.1. </span><strong class="command">head</strong> and <strong class="command">tail</strong><a class="headerlink" href="#head-and-tail" title="Permalink to this heading"></a></h2>
<p>Let us begin with something more lightweight, though.
The <strong class="command">head</strong> function can be used to fetch
a few elements from the beginning of a vector.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;-</span> <span class="m">1</span><span class="o">:</span><span class="m">10</span>
<span class="nf">head</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># head(x, 6)</span>
<span class="c1">## [1] 1 2 3 4 5 6</span>
<span class="nf">head</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>   <span class="c1"># get the first three</span>
<span class="c1">## [1] 1 2 3</span>
<span class="nf">head</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="m">-3</span><span class="p">)</span>  <span class="c1"># skip the last three</span>
<span class="c1">## [1] 1 2 3 4 5 6 7</span>
</pre></div>
</div>
<p>Similarly, <strong class="command">tail</strong> extracts a few elements from the end of a
sequence.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">tail</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># tail(x, 6)</span>
<span class="c1">## [1]  5  6  7  8  9 10</span>
<span class="nf">tail</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>   <span class="c1"># get the last three</span>
<span class="c1">## [1]  8  9 10</span>
<span class="nf">tail</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="m">-3</span><span class="p">)</span>  <span class="c1"># skip the first three</span>
<span class="c1">## [1]  4  5  6  7  8  9 10</span>
</pre></div>
</div>
<p>Both functions work on lists too<a class="footnote-reference brackets" href="#foothead" id="id2">1</a>.
They are useful, e.g., when we wish to preview the contents
of a <em>big</em> object.</p>
</section>
<section id="subsetting-of-and-extracting-from-vectors">
<h2><span class="section-number">5.2. </span>Subsetting of and Extracting from Vectors<a class="headerlink" href="#subsetting-of-and-extracting-from-vectors" title="Permalink to this heading"></a></h2>
<p>Given a vector <code class="docutils literal notranslate"><span class="pre">x</span></code>, “<code class="docutils literal notranslate"><span class="pre">x[i]</span></code>” returns its subset
comprised of elements indicated by the indexer <code class="docutils literal notranslate"><span class="pre">i</span></code>, which
can be a <em>single</em> vector of:</p>
<ul class="simple">
<li><p>nonnegative integers (gives the positions of
elements to retrieve),</p></li>
<li><p>negative integers (gives the positions to omit),</p></li>
<li><p>logical values (states whether the corresponding element should
be fetched or skipped),</p></li>
<li><p>character strings (locates the elements with specific names).</p></li>
</ul>
<section id="nonnegative-indexes">
<h3><span class="section-number">5.2.1. </span>Nonnegative Indexes<a class="headerlink" href="#nonnegative-indexes" title="Permalink to this heading"></a></h3>
<p>Consider the following example vectors:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">seq</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">100</span><span class="p">,</span> <span class="m">10</span><span class="p">))</span>
<span class="c1">##  [1]  10  20  30  40  50  60  70  80  90 100</span>
<span class="p">(</span><span class="n">y</span> <span class="o">&lt;-</span> <span class="nf">list</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">11</span><span class="o">:</span><span class="m">12</span><span class="p">,</span> <span class="m">21</span><span class="o">:</span><span class="m">23</span><span class="p">))</span>
<span class="c1">## [[1]]</span>
<span class="c1">## [1] 1</span>
<span class="c1">## </span>
<span class="c1">## [[2]]</span>
<span class="c1">## [1] 11 12</span>
<span class="c1">## </span>
<span class="c1">## [[3]]</span>
<span class="c1">## [1] 21 22 23</span>
</pre></div>
</div>
<p>The first element in a vector is at index 1. Hence:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="m">1</span><span class="p">]</span>          <span class="c1"># the first element</span>
<span class="c1">## [1] 10</span>
<span class="n">x</span><span class="p">[</span><span class="nf">length</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>  <span class="c1"># the last element</span>
<span class="c1">## [1] 100</span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>We might have wondered why “<code class="docutils literal notranslate"><span class="pre">[1]</span></code>” is being displayed each time
we print out an atomic vector on the console:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">((</span><span class="m">1</span><span class="o">:</span><span class="m">51</span><span class="p">)</span><span class="o">*</span><span class="m">10</span><span class="p">)</span>
<span class="c1">##  [1]  10  20  30  40  50  60  70  80  90 100 110 120 130 140 150 160 170</span>
<span class="c1">## [18] 180 190 200 210 220 230 240 250 260 270 280 290 300 310 320 330 340</span>
<span class="c1">## [35] 350 360 370 380 390 400 410 420 430 440 450 460 470 480 490 500 510</span>
</pre></div>
</div>
<p>It is merely a visual hint indicating which vector element
we  output first in each line.</p>
</div>
<p>Vectorisation is a universal feature of R. Hence, it comes as no surprise
that the indexer can be also of length greater than one.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="nf">length</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>  <span class="c1"># the first and the last</span>
<span class="c1">## [1]  10 100</span>
<span class="n">x</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">]</span>  <span class="c1"># the first three</span>
<span class="c1">## [1] 10 20 30</span>
</pre></div>
</div>
<p>Take note of some boundary cases:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="kc">NA_real_</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">11</span><span class="p">)]</span>  <span class="c1"># repeated, 0, missing, out of bound</span>
<span class="c1">## [1] 10 20 10 30 NA 10 NA</span>
<span class="n">x</span><span class="p">[</span><span class="nf">c</span><span class="p">()]</span>  <span class="c1"># indexing by an empty vector</span>
<span class="c1">## numeric(0)</span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Subsetting with `<strong class="command">[</strong>` yields an object of the same type.</p>
</div>
<p>When applied on lists, the index operator always returns a list as well,
even if we ask for a single element:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="p">[</span><span class="m">2</span><span class="p">]</span>  <span class="c1"># a list that includes the 2nd element</span>
<span class="c1">## [[1]]</span>
<span class="c1">## [1] 11 12</span>
<span class="n">y</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">3</span><span class="p">)]</span>  <span class="c1"># note that this is not the same as x[1, 3] (a different story)</span>
<span class="c1">## [[1]]</span>
<span class="c1">## [1] 1</span>
<span class="c1">## </span>
<span class="c1">## [[2]]</span>
<span class="c1">## [1] 21 22 23</span>
</pre></div>
</div>
<p>If we wish to <em>extract</em> a component, i.e., to dig into what is inside
a list at a specific location, we can refer to `<strong class="command">[[</strong>`:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="p">[[</span><span class="m">2</span><span class="p">]]</span>  <span class="c1"># extract the 2nd element</span>
<span class="c1">## [1] 11 12</span>
</pre></div>
</div>
<p>This is exactly why R displays “<code class="docutils literal notranslate"><span class="pre">[[1]]</span></code>”, “<code class="docutils literal notranslate"><span class="pre">[[2]]</span></code>”, etc.
when printing out lists on the console.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Calling “<code class="docutils literal notranslate"><span class="pre">x[[i]]</span></code>” on an <em>atomic</em> vector, where <code class="docutils literal notranslate"><span class="pre">i</span></code> is a single
value has almost<a class="footnote-reference brackets" href="#footattraalmost" id="id3">2</a> the same effect as “<code class="docutils literal notranslate"><span class="pre">x[i]</span></code>”.
However, `<strong class="command">[[</strong>` generates an error if the subscript
is out of bounds.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>(*)
`<strong class="command">[[</strong>` also supports multiple indexers.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="p">[[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">3</span><span class="p">)]]</span>
<span class="c1">## Error in y[[c(1, 3)]]: subscript out of bounds</span>
</pre></div>
</div>
<p>Its meaning is different from <code class="docutils literal notranslate"><span class="pre">y[</span></code><strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">3)]</span></code>, though;
we are about to extract a single value, remember?
Here, indexing is applied <em>recursively</em>.
Namely, the above is equivalent to <code class="docutils literal notranslate"><span class="pre">y[[1]][[3]]</span></code> – we got an error
because <code class="docutils literal notranslate"><span class="pre">y[[1]]</span></code> is of length smaller than three.</p>
<p>More examples:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="p">[[</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">1</span><span class="p">)]]</span>  <span class="c1"># y[[3]][[1]]</span>
<span class="c1">## [1] 21</span>
<span class="nf">list</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="m">7</span><span class="p">))[[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">)]]</span>  <span class="c1"># 7, not list(7)</span>
<span class="c1">## [1] 7</span>
</pre></div>
</div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Take note of the behaviour in the case of non-existing items:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">)[</span><span class="m">4</span><span class="p">]</span>
<span class="c1">## [1] NA</span>
<span class="nf">list</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">)[</span><span class="m">4</span><span class="p">]</span>
<span class="c1">## [[1]]</span>
<span class="c1">## NULL</span>
<span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">)[[</span><span class="m">4</span><span class="p">]]</span>
<span class="c1">## Error in c(1, 2, 3)[[4]]: subscript out of bounds</span>
<span class="nf">list</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">)[[</span><span class="m">4</span><span class="p">]]</span>
<span class="c1">## Error in list(1, 2, 3)[[4]]: subscript out of bounds</span>
</pre></div>
</div>
</div>
</section>
<section id="negative-indexes">
<h3><span class="section-number">5.2.2. </span>Negative Indexes<a class="headerlink" href="#negative-indexes" title="Permalink to this heading"></a></h3>
<p>The indexer can also be a vector of negative integers.
This way, we can <em>exclude</em> the elements at given positions:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="p">[</span><span class="m">-1</span><span class="p">]</span>  <span class="c1"># all but the first</span>
<span class="c1">## [[1]]</span>
<span class="c1">## [1] 11 12</span>
<span class="c1">## </span>
<span class="c1">## [[2]]</span>
<span class="c1">## [1] 21 22 23</span>
<span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">)]</span>
<span class="c1">## [1]  40  50  60  70  80  90 100</span>
<span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">8</span><span class="o">:</span><span class="m">100</span><span class="p">)]</span>  <span class="c1"># 0, repeated, out of bound indexes</span>
<span class="c1">## [1] 30 40 50 60 70</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Negative and positive indexes cannot be mixed.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="m">-1</span><span class="o">:</span><span class="m">3</span><span class="p">]</span>  <span class="c1"># recall that -1:3 == (-1):3</span>
<span class="c1">## Error in x[-1:3]: only 0&#39;s may be mixed with negative subscripts</span>
</pre></div>
</div>
<p>Also, <code class="docutils literal notranslate"><span class="pre">NA</span></code> indexes are not allowed amongst negative ones.</p>
</div>
</section>
<section id="logical-indexer">
<h3><span class="section-number">5.2.3. </span>Logical Indexer<a class="headerlink" href="#logical-indexer" title="Permalink to this heading"></a></h3>
<p>A vector can also be subsetted by means of a logical vector.
If they both are of identical lengths,
the consecutive elements in the latter indicate whether
the corresponding elements of the indexed vector are supposed to be
selected (<code class="docutils literal notranslate"><span class="pre">TRUE</span></code>) or omitted (<code class="docutils literal notranslate"><span class="pre">FALSE</span></code>).</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#   1***  2      3      4      5***  6***  7      8***  9?   10***</span>
<span class="n">x</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">,</span> <span class="kc">FALSE</span><span class="p">,</span> <span class="kc">FALSE</span><span class="p">,</span> <span class="kc">FALSE</span><span class="p">,</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="kc">FALSE</span><span class="p">,</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span>  <span class="kc">TRUE</span><span class="p">)]</span>
<span class="c1">## [1]  10  50  60  80  NA 100</span>
</pre></div>
</div>
<p>In other words, <code class="docutils literal notranslate"><span class="pre">x[l]</span></code>, where <code class="docutils literal notranslate"><span class="pre">l</span></code> is a logical vector,
returns all <code class="docutils literal notranslate"><span class="pre">x[i]</span></code> with <code class="docutils literal notranslate"><span class="pre">i</span></code> such that <code class="docutils literal notranslate"><span class="pre">l[i]</span></code> is <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>.
Above, we extracted the elements at indexes 1, 5, 6, 8, and 10.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Let us be careful: if the element selector is <code class="docutils literal notranslate"><span class="pre">NA</span></code>,
the selected element will be set to a missing value (for atomic vectors)
or <code class="docutils literal notranslate"><span class="pre">NULL</span></code> (for lists).</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;one&quot;</span><span class="p">,</span> <span class="s">&quot;two&quot;</span><span class="p">,</span> <span class="s">&quot;three&quot;</span><span class="p">)[</span><span class="nf">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="kc">FALSE</span><span class="p">)]</span>
<span class="c1">## [1] NA    &quot;two&quot;</span>
<span class="nf">list</span><span class="p">(</span><span class="s">&quot;one&quot;</span><span class="p">,</span> <span class="s">&quot;two&quot;</span><span class="p">,</span> <span class="s">&quot;three&quot;</span><span class="p">)[</span><span class="nf">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="kc">FALSE</span><span class="p">)]</span>
<span class="c1">## [[1]]</span>
<span class="c1">## NULL</span>
<span class="c1">## </span>
<span class="c1">## [[2]]</span>
<span class="c1">## [1] &quot;two&quot;</span>
</pre></div>
</div>
<p>This, unfortunately, comes with no warning, which might be
problematic when indexers are generated programmatically.</p>
<p>As a remedy, we sometimes pass the logical indexer to the <strong class="command">which</strong>
function first. It returns the indexes of the elements equal to <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>,
ignoring the missing ones.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">which</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="kc">FALSE</span><span class="p">))</span>
<span class="c1">## [1] 2</span>
<span class="nf">c</span><span class="p">(</span><span class="s">&quot;one&quot;</span><span class="p">,</span> <span class="s">&quot;two&quot;</span><span class="p">,</span> <span class="s">&quot;three&quot;</span><span class="p">)[</span><span class="nf">which</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="kc">FALSE</span><span class="p">))]</span>
<span class="c1">## [1] &quot;two&quot;</span>
</pre></div>
</div>
</div>
<p>Recall that in <a class="reference internal" href="130-logical.html#chap-logical"><span class="std std-numref">Chapter 3</span></a>, we have discussed
ample vectorised operations that generate logical vectors.
Anything that yields a logical vector of the same length as <code class="docutils literal notranslate"><span class="pre">x</span></code>
can be passed as an indexer.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&gt;</span> <span class="m">60</span>  <span class="c1"># yes, it is a perfect indexer candidate</span>
<span class="c1">##  [1] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE</span>
<span class="n">x</span><span class="p">[</span><span class="n">x</span> <span class="o">&gt;</span> <span class="m">60</span><span class="p">]</span>  <span class="c1"># select elements in x that are greater than 60</span>
<span class="c1">## [1]  70  80  90 100</span>
<span class="n">x</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;</span> <span class="m">30</span> <span class="o">|</span> <span class="m">70</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">]</span>  <span class="c1"># elements not between 30 and 70</span>
<span class="c1">## [1]  10  20  80  90 100</span>
<span class="n">x</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;</span> <span class="nf">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>  <span class="c1"># elements smaller than the mean</span>
<span class="c1">## [1] 10 20 30 40 50</span>
<span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="o">^</span><span class="m">2</span> <span class="o">&gt;</span> <span class="m">7777</span> <span class="o">|</span> <span class="nf">log10</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="m">1.6</span><span class="p">]</span>  <span class="c1"># indexing via a transformed version of x</span>
<span class="c1">## [1]  10  20  30  90 100</span>
<span class="p">(</span><span class="n">z</span> <span class="o">&lt;-</span> <span class="nf">round</span><span class="p">(</span><span class="nf">runif</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="m">2</span><span class="p">))</span>  <span class="c1"># ten pseudorandom numbers</span>
<span class="c1">##  [1] 0.29 0.79 0.41 0.88 0.94 0.05 0.53 0.89 0.55 0.46</span>
<span class="n">x</span><span class="p">[</span><span class="n">z</span> <span class="o">&lt;=</span> <span class="m">0.5</span><span class="p">]</span>  <span class="c1"># indexing based on z, not x — not a problem</span>
<span class="c1">## [1]  10  30  60 100</span>
</pre></div>
</div>
<p>The indexer is always evaluated first and then passed to the subsetting
operation – this operation  does not care how such a
logical vector was generated.</p>
<p>Furthermore, recycling rule is of course applied when necessary:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="kc">FALSE</span><span class="p">,</span> <span class="kc">TRUE</span><span class="p">)]</span>  <span class="c1"># every second element</span>
<span class="c1">## [1]  20  40  60  80 100</span>
<span class="n">y</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">,</span> <span class="kc">FALSE</span><span class="p">)]</span>  <span class="c1"># interestingly, there is no warning here</span>
<span class="c1">## [[1]]</span>
<span class="c1">## [1] 1</span>
<span class="c1">## </span>
<span class="c1">## [[2]]</span>
<span class="c1">## [1] 21 22 23</span>
</pre></div>
</div>
<div class="proof proof-type-exercise" id="id8">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.1</span>
        
    </div><div class="proof-content">
<p>Consider a simple database about six people, their most
favourite dishes, and birth years.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">name</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;Graham&quot;</span><span class="p">,</span> <span class="s">&quot;John&quot;</span><span class="p">,</span> <span class="s">&quot;Terry&quot;</span><span class="p">,</span> <span class="s">&quot;Eric&quot;</span><span class="p">,</span>  <span class="s">&quot;Michael&quot;</span><span class="p">,</span> <span class="s">&quot;Terry&quot;</span><span class="p">)</span>
<span class="n">food</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;bacon&quot;</span><span class="p">,</span>  <span class="s">&quot;spam&quot;</span><span class="p">,</span> <span class="s">&quot;spam&quot;</span><span class="p">,</span>  <span class="s">&quot;eggs&quot;</span><span class="p">,</span>  <span class="s">&quot;spam&quot;</span><span class="p">,</span>    <span class="s">&quot;beans&quot;</span><span class="p">)</span>
<span class="n">year</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span> <span class="m">1941</span><span class="p">,</span>     <span class="m">1939</span><span class="p">,</span>   <span class="m">1942</span><span class="p">,</span>    <span class="m">1943</span><span class="p">,</span>    <span class="m">1943</span><span class="p">,</span>      <span class="m">1940</span>  <span class="p">)</span>
</pre></div>
</div>
<p>The consecutive elements in different vectors correspond to each other,
e.g., Graham was born in 1941 and his favourite food was bacon.</p>
<ul class="simple">
<li><p>List the names of people born in 1941 or 1942.</p></li>
<li><p>List the names of those who like spam.</p></li>
<li><p>List the names of those who like spam and were born after 1940.</p></li>
<li><p>Compute the average birth year of the lovers of spam.</p></li>
<li><p>Give the average age, in 1969, of those who didn’t find spam
utmostly delicious.</p></li>
</ul>
<p>The answers to the above must be provided programmatically,
i.e., we do not just write <code class="docutils literal notranslate"><span class="pre">&quot;Eric&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;Graham&quot;</span></code>.
The code must be generic enough so that it works
in the case of any other database of this kind, no matter
its size.</p>
</div></div><div class="proof proof-type-exercise" id="id9">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.2</span>
        
    </div><div class="proof-content">
<p>Remove missing values from a given vector without referring
to the <strong class="command">na.omit</strong> function.</p>
</div></div></section>
<section id="character-indexer">
<h3><span class="section-number">5.2.4. </span>Character Indexer<a class="headerlink" href="#character-indexer" title="Permalink to this heading"></a></h3>
<p>If a vector is equipped with the <code class="docutils literal notranslate"><span class="pre">names</span></code> attribute,
such as this one:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">structure</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">letters</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">])</span>  <span class="c1"># add names</span>
<span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1">##   a   b   c   d   e   f   g   h   i   j </span>
<span class="c1">##  10  20  30  40  50  60  70  80  90 100</span>
</pre></div>
</div>
<p>These labels can be referred to for the purpose of extracting the elements.
To do this, we use an indexer which is a character vector:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;f&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;g&quot;</span><span class="p">,</span> <span class="s">&quot;z&quot;</span><span class="p">)]</span>
<span class="c1">##    a    f    a    g &lt;NA&gt; </span>
<span class="c1">##   10   60   10   70   NA</span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>We have said that special object attributes add <em>extra</em> functionality
on top of the existing ones. Therefore, indexing by means
of positive, negative, and logical vectors is of course still available:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">]</span>
<span class="c1">##  a  b  c </span>
<span class="c1">## 10 20 30</span>
<span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">)]</span>
<span class="c1">##   f   g   h   i   j </span>
<span class="c1">##  60  70  80  90 100</span>
<span class="n">x</span><span class="p">[</span><span class="n">x</span> <span class="o">&gt;</span> <span class="m">70</span><span class="p">]</span>
<span class="c1">##   h   i   j </span>
<span class="c1">##  80  90 100</span>
</pre></div>
</div>
</div>
<p>Lists can also be subsetted this way.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">y</span> <span class="o">&lt;-</span> <span class="nf">structure</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;first&quot;</span><span class="p">,</span> <span class="s">&quot;second&quot;</span><span class="p">,</span> <span class="s">&quot;third&quot;</span><span class="p">)))</span>
<span class="c1">## $first</span>
<span class="c1">## [1] 1</span>
<span class="c1">## </span>
<span class="c1">## $second</span>
<span class="c1">## [1] 11 12</span>
<span class="c1">## </span>
<span class="c1">## $third</span>
<span class="c1">## [1] 21 22 23</span>
<span class="n">y</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;first&quot;</span><span class="p">,</span> <span class="s">&quot;second&quot;</span><span class="p">)]</span>
<span class="c1">## $first</span>
<span class="c1">## [1] 1</span>
<span class="c1">## </span>
<span class="c1">## $second</span>
<span class="c1">## [1] 11 12</span>
<span class="n">y</span><span class="p">[</span><span class="s">&quot;third&quot;</span><span class="p">]</span>    <span class="c1"># result is a list</span>
<span class="c1">## $third</span>
<span class="c1">## [1] 21 22 23</span>
<span class="n">y</span><span class="p">[[</span><span class="s">&quot;third&quot;</span><span class="p">]]</span>  <span class="c1"># result is the specific element unwrapped</span>
<span class="c1">## [1] 21 22 23</span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Labels do not have to be unique. When we have repeated names,
the first matching element is extracted:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">structure</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">))[</span><span class="s">&quot;a&quot;</span><span class="p">]</span>
<span class="c1">## a </span>
<span class="c1">## 1</span>
</pre></div>
</div>
</div>
<p>There is no direct way to select all <em>but</em> given names,
just like with negative integer indexers. For a workaround,
see <a class="reference internal" href="#sec-match"><span class="std std-numref">Section 5.4.1</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>(*) The dollar operator, `<strong class="command">$</strong>`, can also be used to extract
a single element from a named list in some contexts; see
<a class="reference internal" href="320-language.html#sec-dollar"><span class="std std-numref">Section 15.1</span></a> for discussion. If <code class="docutils literal notranslate"><span class="pre">label</span></code> is a syntactically
valid name, then <code class="docutils literal notranslate"><span class="pre">x$label</span></code> does the same job as <code class="docutils literal notranslate"><span class="pre">x[[&quot;label&quot;]]</span></code>.
We are minimalist-by-design here, hence we will tend to avoid this
operator, as it does not really increase the expressive power of our
function repertoire. Also, it does not work on atomic vectors
nor on matrices.</p>
</div>
<div class="proof proof-type-exercise" id="id10">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.3</span>
        
    </div><div class="proof-content">
<p>Rewrite the solution to the above spam-lovers exercise
assuming that we have the three features wrapped inside a list now:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">people</span> <span class="o">&lt;-</span> <span class="nf">list</span><span class="p">(</span>
    <span class="n">Name</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Graham&quot;</span><span class="p">,</span> <span class="s">&quot;John&quot;</span><span class="p">,</span> <span class="s">&quot;Terry&quot;</span><span class="p">,</span> <span class="s">&quot;Eric&quot;</span><span class="p">,</span>  <span class="s">&quot;Michael&quot;</span><span class="p">,</span> <span class="s">&quot;Terry&quot;</span><span class="p">,</span> <span class="s">&quot;Steve&quot;</span><span class="p">),</span>
    <span class="n">Food</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;bacon&quot;</span><span class="p">,</span>  <span class="s">&quot;spam&quot;</span><span class="p">,</span> <span class="s">&quot;spam&quot;</span><span class="p">,</span>  <span class="s">&quot;eggs&quot;</span><span class="p">,</span>  <span class="s">&quot;spam&quot;</span><span class="p">,</span>    <span class="s">&quot;beans&quot;</span><span class="p">,</span> <span class="s">&quot;spam&quot;</span><span class="p">),</span>
    <span class="n">Year</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span> <span class="m">1941</span><span class="p">,</span>     <span class="m">1939</span><span class="p">,</span>   <span class="m">1942</span><span class="p">,</span>    <span class="m">1943</span><span class="p">,</span>    <span class="m">1943</span><span class="p">,</span>      <span class="m">1940</span><span class="p">,</span>   <span class="kc">NA_real_</span><span class="p">)</span>
<span class="p">))</span>
<span class="c1">## $Name</span>
<span class="c1">## [1] &quot;Graham&quot;  &quot;John&quot;    &quot;Terry&quot;   &quot;Eric&quot;    &quot;Michael&quot; &quot;Terry&quot;   &quot;Steve&quot;  </span>
<span class="c1">## </span>
<span class="c1">## $Food</span>
<span class="c1">## [1] &quot;bacon&quot; &quot;spam&quot;  &quot;spam&quot;  &quot;eggs&quot;  &quot;spam&quot;  &quot;beans&quot; &quot;spam&quot; </span>
<span class="c1">## </span>
<span class="c1">## $Year</span>
<span class="c1">## [1] 1941 1939 1942 1943 1943 1940   NA</span>
</pre></div>
</div>
<p>Do not refer to <code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">food</span></code>, and <code class="docutils literal notranslate"><span class="pre">year</span></code> directly.
Instead, use the full <code class="docutils literal notranslate"><span class="pre">people[[&quot;Name&quot;]]</span></code> etc. accessors.
There is no need to pout, it is just tiny bit of extra work.
Also note that we now have Steve amongst us.</p>
</div></div></section>
</section>
<section id="replacing-elements">
<h2><span class="section-number">5.3. </span>Replacing Elements<a class="headerlink" href="#replacing-elements" title="Permalink to this heading"></a></h2>
<section id="modifying-atomic-vectors">
<h3><span class="section-number">5.3.1. </span>Modifying Atomic Vectors<a class="headerlink" href="#modifying-atomic-vectors" title="Permalink to this heading"></a></h3>
<p>There are also <em>replacement</em> versions of the above indexing schemes.
They allow us to substitute some new content for the old one.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;-</span> <span class="m">1</span><span class="o">:</span><span class="m">12</span><span class="p">)</span>
<span class="c1">##  [1]  1  2  3  4  5  6  7  8  9 10 11 12</span>
<span class="n">x</span><span class="p">[</span><span class="nf">length</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span> <span class="o">&lt;-</span> <span class="m">42</span>  <span class="c1"># modify the last element</span>
<span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1">##  [1]  1  2  3  4  5  6  7  8  9 10 11 42</span>
</pre></div>
</div>
<p>The principles of vectorisation, recycling rule, and implicit coercion
are all in place:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">,</span> <span class="kc">FALSE</span><span class="p">)]</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;c&quot;</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1">##  [1] &quot;a&quot;  &quot;2&quot;  &quot;b&quot;  &quot;4&quot;  &quot;c&quot;  &quot;6&quot;  &quot;a&quot;  &quot;8&quot;  &quot;b&quot;  &quot;10&quot; &quot;c&quot;  &quot;42&quot;</span>
</pre></div>
</div>
<p>Long story long: first, to make sure that the new content
can be poured into old wineskin, R needed to convert the numeric
vector to a character one; compare <a class="reference internal" href="140-list.html#sec-type-hierarchy"><span class="std std-numref">Section 4.1</span></a>.
Then, every second element therein, a total of six items,
was replaced by a recycled version of the replacement sequence
of length 3. Finally, the name “<code class="docutils literal notranslate"><span class="pre">x</span></code>” was re-bound to such
a brought-forth object and the previous one became forgotten.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more details on replacement functions in general,
see <a class="reference internal" href="210-design.html#sec-replacementfun"><span class="std std-numref">Section 9.4.5</span></a>.
Such operations alter the state of the object
they are called on
(quite a rare behaviour in functional languages).</p>
</div>
<div class="proof proof-type-exercise" id="id11">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.4</span>
        
    </div><div class="proof-content">
<p>Replace missing values in a given numeric vector
with the arithmetic mean of well-defined observations therein.</p>
</div></div></section>
<section id="modifying-lists">
<h3><span class="section-number">5.3.2. </span>Modifying Lists<a class="headerlink" href="#modifying-lists" title="Permalink to this heading"></a></h3>
<p>List contents can be altered as well. For modifying individual elements,
the safest option is to use the replacement version
of the `<strong class="command">[[</strong>` operator:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">&lt;-</span> <span class="nf">list</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">)</span>
<span class="n">y</span><span class="p">[[</span><span class="m">1</span><span class="p">]]</span> <span class="o">&lt;-</span> <span class="m">100</span><span class="o">:</span><span class="m">110</span>
<span class="n">y</span><span class="p">[[</span><span class="s">&quot;c&quot;</span><span class="p">]]</span> <span class="o">&lt;-</span> <span class="o">-</span><span class="n">y</span><span class="p">[[</span><span class="s">&quot;c&quot;</span><span class="p">]]</span>
<span class="nf">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="c1">## $a</span>
<span class="c1">##  [1] 100 101 102 103 104 105 106 107 108 109 110</span>
<span class="c1">## </span>
<span class="c1">## $b</span>
<span class="c1">## [1] 1 2</span>
<span class="c1">## </span>
<span class="c1">## $c</span>
<span class="c1">## [1] -1 -2 -3</span>
</pre></div>
</div>
<p>The replacement version
of `<strong class="command">[</strong>` modifies a whole sub-list:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="nf">list</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;c&quot;</span><span class="p">),</span> <span class="nf">c</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">,</span> <span class="kc">FALSE</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="c1">## $a</span>
<span class="c1">## [1] 1</span>
<span class="c1">## </span>
<span class="c1">## $b</span>
<span class="c1">## [1] &quot;a&quot; &quot;b&quot; &quot;c&quot;</span>
<span class="c1">## </span>
<span class="c1">## $c</span>
<span class="c1">## [1]  TRUE FALSE</span>
</pre></div>
</div>
<p>Moreover:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="nf">list</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">)</span>  <span class="c1"># replace 1 element with 1 object</span>
<span class="n">y</span><span class="p">[</span><span class="m">-1</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="m">10</span><span class="o">:</span><span class="m">11</span>      <span class="c1"># replace 2 elements with 2 vectors of length 1</span>
<span class="nf">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="c1">## $a</span>
<span class="c1">##  [1]  1  2  3  4  5  6  7  8  9 10</span>
<span class="c1">## </span>
<span class="c1">## $b</span>
<span class="c1">## [1] 10</span>
<span class="c1">## </span>
<span class="c1">## $c</span>
<span class="c1">## [1] 11</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Let <code class="docutils literal notranslate"><span class="pre">idx</span></code> be a vector of positive indexes
of elements to be modified.
Overall, calling “<code class="docutils literal notranslate"><span class="pre">y[idx]</span> <span class="pre">&lt;-</span> <span class="pre">z</span></code>” behaves as if we wrote:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">y[[idx[1]]]</span> <span class="pre">&lt;-</span> <span class="pre">z[[1]]</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y[[idx[2]]]</span> <span class="pre">&lt;-</span> <span class="pre">z[[2]]</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y[[idx[3]]]</span> <span class="pre">&lt;-</span> <span class="pre">z[[3]]</span></code>,</p></li>
</ol>
<p>and so forth.</p>
<p>Furthermore, <code class="docutils literal notranslate"><span class="pre">z</span></code> (but not <code class="docutils literal notranslate"><span class="pre">idx</span></code>) will be recycled if necessary,
i.e., we take <code class="docutils literal notranslate"><span class="pre">z[[j</span> <span class="pre">%%</span> <span class="pre">length(z)]]</span></code> for consecutive <code class="docutils literal notranslate"><span class="pre">j</span></code>s
from 1 to the length of <code class="docutils literal notranslate"><span class="pre">idx</span></code>.</p>
</div>
<div class="proof proof-type-exercise" id="id12">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.5</span>
        
    </div><div class="proof-content">
<p>Reflect upon the results of the following expressions:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">y[1]</span> <span class="pre">&lt;-</span> </code><strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">(&quot;a&quot;,</span> <span class="pre">&quot;b&quot;,</span> <span class="pre">&quot;c&quot;)</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y[[1]]</span> <span class="pre">&lt;-</span> </code><strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">(&quot;a&quot;,</span> <span class="pre">&quot;b&quot;,</span> <span class="pre">&quot;c&quot;)</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y[[1]]</span> <span class="pre">&lt;-</span> </code><strong class="command">list</strong><code class="code docutils literal notranslate"><span class="pre">(c(&quot;a&quot;,</span> <span class="pre">&quot;b&quot;,</span> <span class="pre">&quot;c&quot;))</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y[1:3]</span> <span class="pre">&lt;-</span> </code><strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">(&quot;a&quot;,</span> <span class="pre">&quot;b&quot;,</span> <span class="pre">&quot;c&quot;)</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y[1:3]</span> <span class="pre">&lt;-</span> </code><strong class="command">list</strong><code class="code docutils literal notranslate"><span class="pre">(c(&quot;a&quot;,</span> <span class="pre">&quot;b&quot;,</span> <span class="pre">&quot;c&quot;))</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y[1:3]</span> <span class="pre">&lt;-</span> <span class="pre">&quot;a&quot;</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y[1:3]</span> <span class="pre">&lt;-</span> </code><strong class="command">list</strong><code class="code docutils literal notranslate"><span class="pre">(&quot;a&quot;)</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y[</span></code><strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">2,</span> <span class="pre">1)]</span> <span class="pre">&lt;-</span> </code><strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">(&quot;a&quot;,</span> <span class="pre">&quot;b&quot;,</span> <span class="pre">&quot;c&quot;)</span></code>,</p></li>
</ul>
</div></div><div class="admonition important">
<p class="admonition-title">Important</p>
<p>Setting a list item to <code class="docutils literal notranslate"><span class="pre">NULL</span></code> removes it from the list completely.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">&lt;-</span> <span class="nf">list</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">)</span>
<span class="n">y</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="kc">NULL</span>       <span class="c1"># removes the 1st element (i.e., 1)</span>
<span class="n">y</span><span class="p">[[</span><span class="m">1</span><span class="p">]]</span> <span class="o">&lt;-</span> <span class="kc">NULL</span>     <span class="c1"># removes the 1st element (i.e., now 2)</span>
<span class="n">y</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="nf">list</span><span class="p">(</span><span class="kc">NULL</span><span class="p">)</span> <span class="c1"># sets the 1st element (i.e., now 3) to NULL</span>
<span class="nf">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="c1">## [[1]]</span>
<span class="c1">## NULL</span>
<span class="c1">## </span>
<span class="c1">## [[2]]</span>
<span class="c1">## [1] 4</span>
</pre></div>
</div>
<p>The same notation convention is used for dropping
object attributes; see <a class="reference internal" href="210-design.html#sec-replacementfun"><span class="std std-numref">Section 9.4.5</span></a>.</p>
</div>
</section>
<section id="inserting-new-elements">
<span id="sec-insert-new-elem"></span><h3><span class="section-number">5.3.3. </span>Inserting New Elements<a class="headerlink" href="#inserting-new-elements" title="Permalink to this heading"></a></h3>
<p>New elements can be pushed at the end of the vector quite easily<a class="footnote-reference brackets" href="#footperf" id="id4">3</a>.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;-</span> <span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">)</span>
<span class="c1">## [1] 1 2 3 4 5</span>
<span class="n">x</span><span class="p">[</span><span class="nf">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="m">+1</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="m">6</span>  <span class="c1"># insert at the end</span>
<span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1">## [1] 1 2 3 4 5 6</span>
<span class="n">x</span><span class="p">[</span><span class="m">10</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="m">10</span>  <span class="c1"># insert at the end but add more items</span>
<span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1">##  [1]  1  2  3  4  5  6 NA NA NA 10</span>
</pre></div>
</div>
<p>The elements to be inserted can be named as well:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="s">&quot;a&quot;</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="m">11</span>  <span class="c1"># still inserts at the end</span>
<span class="n">x</span><span class="p">[</span><span class="s">&quot;z&quot;</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="m">12</span>
<span class="n">x</span><span class="p">[</span><span class="s">&quot;c&quot;</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="m">13</span>
<span class="n">x</span><span class="p">[</span><span class="s">&quot;z&quot;</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="m">14</span>  <span class="c1"># z is already there; replace</span>
<span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1">##                                a  z  c </span>
<span class="c1">##  1  2  3  4  5  6 NA NA NA 10 11 14 13</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">x</span></code> was not equipped with the <code class="docutils literal notranslate"><span class="pre">names</span></code> attribute before –
the unlabelled elements were assigned blank labels (empty strings).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is not possible to
insert new elements at the beginning or in the middle of
a sequence, at least not with the index operator.
By writing “<code class="docutils literal notranslate"><span class="pre">x[3:4]</span> <span class="pre">&lt;-</span> <span class="pre">1:5</span></code>” we do not replace two elements
in the middle by five other ones.
However, we can always use the <strong class="command">c</strong> function to slice
parts of the vector and intertwine them with some new content:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">seq</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">100</span><span class="p">,</span> <span class="m">10</span><span class="p">)</span>
<span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">],</span> <span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="m">5</span><span class="o">:</span><span class="m">7</span><span class="p">])</span>
<span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1">##  [1] 10 20  1  2  3  4  5 50 60 70</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="functions-related-to-indexing">
<span id="sec-fun-indexing"></span><h2><span class="section-number">5.4. </span>Functions Related to Indexing<a class="headerlink" href="#functions-related-to-indexing" title="Permalink to this heading"></a></h2>
<p>Let us review some operations which pinpoint interesting
elements in a vector (or functions based on these).</p>
<section id="matching-of-elements-in-another-vector">
<span id="sec-match"></span><h3><span class="section-number">5.4.1. </span>Matching of Elements in Another Vector<a class="headerlink" href="#matching-of-elements-in-another-vector" title="Permalink to this heading"></a></h3>
<p>We know that the `<strong class="command">==</strong>` operator acts in an elementwise manner.
It compares each element in a vector on the lefthand side
to the <em>corresponding</em> element in a vector on the right side.
Thus, missing values and the recycling rule aside,
if <code class="docutils literal notranslate"><span class="pre">z</span> <span class="pre">&lt;-</span> <span class="pre">(x</span> <span class="pre">==</span> <span class="pre">y)</span></code>, then <code class="docutils literal notranslate"><span class="pre">z[i]</span></code> is <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> if and only if <code class="docutils literal notranslate"><span class="pre">x[i]</span> <span class="pre">==</span> <span class="pre">y[i]</span></code>.</p>
<p>The  `<strong class="command">%in%</strong>` operator<a class="footnote-reference brackets" href="#footinname" id="id5">4</a>
is vectorised differently:
it checks whether each element on the lefthand side
matches <em>one of</em> the elements on the right.
Given <code class="docutils literal notranslate"><span class="pre">z</span> <span class="pre">&lt;-</span> <span class="pre">(x</span> <span class="pre">%in%</span> <span class="pre">y)</span></code>, <code class="docutils literal notranslate"><span class="pre">z[i]</span></code> is <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>
whenever <code class="docutils literal notranslate"><span class="pre">x[i]</span> <span class="pre">==</span> <span class="pre">y[j]</span></code> for some <code class="docutils literal notranslate"><span class="pre">j</span></code>.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;spam&quot;</span><span class="p">,</span> <span class="s">&quot;bacon&quot;</span><span class="p">,</span> <span class="s">&quot;spam&quot;</span><span class="p">,</span> <span class="s">&quot;eggs&quot;</span><span class="p">,</span> <span class="s">&quot;spam&quot;</span><span class="p">)</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;eggs&quot;</span><span class="p">,</span> <span class="s">&quot;spam&quot;</span><span class="p">,</span> <span class="s">&quot;ham&quot;</span><span class="p">)</span>
<span class="c1">## [1]  TRUE FALSE  TRUE  TRUE  TRUE</span>
</pre></div>
</div>
<div class="proof proof-type-example" id="id13">

    <div class="proof-title">
        <span class="proof-type">Example 5.6</span>
        
    </div><div class="proof-content">
<p>Here is how we can remove the elements of a vector that have
been assigned specified labels.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">structure</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">12</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">month.abb</span><span class="p">))</span>  <span class="c1"># example vector</span>
<span class="c1">## Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec </span>
<span class="c1">##   1   2   3   4   5   6   7   8   9  10  11  12</span>
<span class="n">x</span><span class="p">[</span><span class="o">!</span><span class="p">(</span><span class="nf">names</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;Jan&quot;</span><span class="p">,</span> <span class="s">&quot;May&quot;</span><span class="p">,</span> <span class="s">&quot;Sep&quot;</span><span class="p">,</span> <span class="s">&quot;Oct&quot;</span><span class="p">))]</span>  <span class="c1"># get rid of some elements</span>
<span class="c1">## Feb Mar Apr Jun Jul Aug Nov Dec </span>
<span class="c1">##   2   3   4   6   7   8  11  12</span>
</pre></div>
</div>
</div></div><p>More generally, <strong class="command">match</strong><code class="code docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> gives us the index of the
element in <code class="docutils literal notranslate"><span class="pre">y</span></code> that matches each <code class="docutils literal notranslate"><span class="pre">x[i]</span></code>.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">match</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;spam&quot;</span><span class="p">,</span> <span class="s">&quot;bacon&quot;</span><span class="p">,</span> <span class="s">&quot;spam&quot;</span><span class="p">,</span> <span class="s">&quot;eggs&quot;</span><span class="p">,</span> <span class="s">&quot;spam&quot;</span><span class="p">),</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;eggs&quot;</span><span class="p">,</span> <span class="s">&quot;spam&quot;</span><span class="p">,</span> <span class="s">&quot;ham&quot;</span><span class="p">))</span>
<span class="c1">## [1]  2 NA  2  1  2</span>
<span class="nf">match</span><span class="p">(</span><span class="n">month.abb</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;Jan&quot;</span><span class="p">,</span> <span class="s">&quot;May&quot;</span><span class="p">,</span> <span class="s">&quot;Sep&quot;</span><span class="p">,</span> <span class="s">&quot;Oct&quot;</span><span class="p">))</span>  <span class="c1"># is the month on the list?</span>
<span class="c1">##  [1]  1 NA NA NA  2 NA NA NA  3  4 NA NA</span>
<span class="nf">match</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Jan&quot;</span><span class="p">,</span> <span class="s">&quot;May&quot;</span><span class="p">,</span> <span class="s">&quot;Sep&quot;</span><span class="p">,</span> <span class="s">&quot;Oct&quot;</span><span class="p">),</span> <span class="n">month.abb</span><span class="p">)</span>  <span class="c1"># which month is it?</span>
<span class="c1">## [1]  1  5  9 10</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">NA_real_</span></code> denotes (by default) a no-match.</p>
<div class="proof proof-type-exercise" id="id14">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.7</span>
        
    </div><div class="proof-content">
<p>Check out the documentation of `<strong class="command">%in%</strong>`
to see how this operator is reduced to a call to <strong class="command">match</strong>.
Also, verify that it treats missing values as well-defined ones.</p>
</div></div><p>If the elements in <code class="docutils literal notranslate"><span class="pre">y</span></code> are not unique, the smallest index <code class="docutils literal notranslate"><span class="pre">j</span></code>
such that <code class="docutils literal notranslate"><span class="pre">x[i]</span> <span class="pre">==</span> <span class="pre">y[j]</span></code> is returned.
Therefore, for example, <strong class="command">match</strong><code class="code docutils literal notranslate"><span class="pre">(TRUE,</span> <span class="pre">l)</span></code> can be used to
fetch the index of the first occurrence of a positive value
in a logical vector <code class="docutils literal notranslate"><span class="pre">l</span></code>.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">round</span><span class="p">(</span><span class="nf">runif</span><span class="p">(</span><span class="m">10</span><span class="p">),</span> <span class="m">2</span><span class="p">))</span>  <span class="c1"># example vector</span>
<span class="c1">##  [1] 0.29 0.79 0.41 0.88 0.94 0.05 0.53 0.89 0.55 0.46</span>
<span class="nf">match</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">,</span> <span class="n">x</span><span class="o">&gt;</span><span class="m">0.8</span><span class="p">)</span>  <span class="c1"># index of the first value &gt; 0.8 (from the left)</span>
<span class="c1">## [1] 4</span>
</pre></div>
</div>
</section>
<section id="assigning-numbers-into-intervals">
<h3><span class="section-number">5.4.2. </span>Assigning Numbers into Intervals<a class="headerlink" href="#assigning-numbers-into-intervals" title="Permalink to this heading"></a></h3>
<p><strong class="command">findInterval</strong> can come in handy
where the assigning of numeric values
into real intervals is needed. Namely,
<code class="docutils literal notranslate"><span class="pre">z</span> <span class="pre">&lt;-</span> </code><strong class="command">findInterval</strong><code class="code docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> for increasing <code class="docutils literal notranslate"><span class="pre">y</span></code>
gives <code class="docutils literal notranslate"><span class="pre">z[i]</span></code> being the index <code class="docutils literal notranslate"><span class="pre">j</span></code> such that <code class="docutils literal notranslate"><span class="pre">x[i]</span></code>
is between <code class="docutils literal notranslate"><span class="pre">y[j]</span></code> (by default, inclusive)
and <code class="docutils literal notranslate"><span class="pre">y[j+1]</span></code> (by default, exclusive).</p>
<p>For example, a sequence of five knots
<span class="math notranslate nohighlight">\(\boldsymbol{y}=(-\infty, 0.25, 0.5, 0.75, \infty)\)</span>
yields a division of the real line to the following four intervals:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{cccc}
[-\infty, 0.25) &amp; [0.25, 0.5) &amp; [0.5, 0.75) &amp; [0.75, \infty) \\
\text{\footnotesize (1)} &amp; \text{\footnotesize (2)} &amp; \text{\footnotesize (3)} &amp; \text{\footnotesize (4)} \\
\end{array}
\end{split}\]</div>
<p>Hence, for instance:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">findInterval</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0.2</span><span class="p">,</span> <span class="m">0.25</span><span class="p">,</span> <span class="m">0.4</span><span class="p">,</span> <span class="m">0.66</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span> <span class="nf">c</span><span class="p">(</span><span class="o">-</span><span class="kc">Inf</span><span class="p">,</span> <span class="m">0.25</span><span class="p">,</span> <span class="m">0.5</span><span class="p">,</span> <span class="m">0.75</span><span class="p">,</span> <span class="kc">Inf</span><span class="p">))</span>
<span class="c1">## [1] 1 1 2 2 3 4</span>
</pre></div>
</div>
<div class="proof proof-type-exercise" id="id15">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.8</span>
        
    </div><div class="proof-content">
<p>Refer to the manual of <strong class="command">findInterval</strong> to verify the function’s behaviour
when we do not include <span class="math notranslate nohighlight">\(\pm\infty\)</span> as end points
and how to make <span class="math notranslate nohighlight">\(\infty\)</span> classified as a member of the 4th interval.</p>
</div></div><div class="proof proof-type-exercise" id="id16">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.9</span>
        
    </div><div class="proof-content">
<p>Using a call to <strong class="command">findInterval</strong>, write a statement
that generates a logical vector whose <em>i</em>-th element indicates
whether <code class="docutils literal notranslate"><span class="pre">x[i]</span></code> is in the interval <span class="math notranslate nohighlight">\([0.25, 0.5]\)</span>.
Was this easier to write than an expression involving
`<strong class="command">&lt;=</strong>` and `<strong class="command">&gt;=</strong>`?</p>
</div></div></section>
<section id="splitting-vectors-into-subgroups">
<span id="sec-split"></span><h3><span class="section-number">5.4.3. </span>Splitting Vectors into Subgroups<a class="headerlink" href="#splitting-vectors-into-subgroups" title="Permalink to this heading"></a></h3>
<p><strong class="command">split</strong><code class="code docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">z)</span></code> can take the output of <strong class="command">match</strong> or
<strong class="command">findInterval</strong> (and many other operations) and divide
the elements in a vector <code class="docutils literal notranslate"><span class="pre">x</span></code>
into subgroups corresponding to identical <code class="docutils literal notranslate"><span class="pre">z</span></code>s.</p>
<p>For instance, we can assign people into groups determined
by their favourite dish:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">name</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;Graham&quot;</span><span class="p">,</span> <span class="s">&quot;John&quot;</span><span class="p">,</span> <span class="s">&quot;Terry&quot;</span><span class="p">,</span> <span class="s">&quot;Eric&quot;</span><span class="p">,</span>  <span class="s">&quot;Michael&quot;</span><span class="p">,</span> <span class="s">&quot;Terry&quot;</span><span class="p">)</span>
<span class="n">food</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;bacon&quot;</span><span class="p">,</span>  <span class="s">&quot;spam&quot;</span><span class="p">,</span> <span class="s">&quot;spam&quot;</span><span class="p">,</span>  <span class="s">&quot;eggs&quot;</span><span class="p">,</span>  <span class="s">&quot;spam&quot;</span><span class="p">,</span>    <span class="s">&quot;beans&quot;</span><span class="p">)</span>
<span class="nf">split</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">food</span><span class="p">)</span>  <span class="c1"># group names with respect to food</span>
<span class="c1">## $bacon</span>
<span class="c1">## [1] &quot;Graham&quot;</span>
<span class="c1">## </span>
<span class="c1">## $beans</span>
<span class="c1">## [1] &quot;Terry&quot;</span>
<span class="c1">## </span>
<span class="c1">## $eggs</span>
<span class="c1">## [1] &quot;Eric&quot;</span>
<span class="c1">## </span>
<span class="c1">## $spam</span>
<span class="c1">## [1] &quot;John&quot;    &quot;Terry&quot;   &quot;Michael&quot;</span>
</pre></div>
</div>
<p>The result is a named list with labels determined by the unique
elements in the 2nd vector.</p>
<p>Another example: here are some numbers pigeonholed into
the four previously mentioned intervals:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0.2</span><span class="p">,</span> <span class="m">0.25</span><span class="p">,</span> <span class="m">0.4</span><span class="p">,</span> <span class="m">0.66</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
<span class="nf">split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nf">findInterval</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="o">-</span><span class="kc">Inf</span><span class="p">,</span> <span class="m">0.25</span><span class="p">,</span> <span class="m">0.5</span><span class="p">,</span> <span class="m">0.75</span><span class="p">,</span> <span class="kc">Inf</span><span class="p">)))</span>
<span class="c1">## $`1`</span>
<span class="c1">## [1] 0.0 0.2</span>
<span class="c1">## </span>
<span class="c1">## $`2`</span>
<span class="c1">## [1] 0.25 0.40</span>
<span class="c1">## </span>
<span class="c1">## $`3`</span>
<span class="c1">## [1] 0.66</span>
<span class="c1">## </span>
<span class="c1">## $`4`</span>
<span class="c1">## [1] 1</span>
</pre></div>
</div>
<p>Missing values in the second argument will result in the corresponding
values in the first argument ignored.
Also, unsurprisingly, recycling rule is applied when necessary.</p>
<p>We can also split <code class="docutils literal notranslate"><span class="pre">x</span></code> into groups defined by a combination
of levels of two or more variables <code class="docutils literal notranslate"><span class="pre">z1</span></code>, <code class="docutils literal notranslate"><span class="pre">z2</span></code>, etc.,
by calling <strong class="command">split</strong><code class="code docutils literal notranslate"><span class="pre">(x,</span> </code><strong class="command">list</strong><code class="code docutils literal notranslate"><span class="pre">(z1,</span> <span class="pre">z2,</span> <span class="pre">...))</span></code>.</p>
<div class="proof proof-type-example" id="id17">

    <div class="proof-title">
        <span class="proof-type">Example 5.10</span>
        
    </div><div class="proof-content">
<p>The built-in <code class="docutils literal notranslate"><span class="pre">ToothGrowth</span></code> is a named list
(with some extra attributes that makes us rather call it a data frame;
see <a class="reference internal" href="240-data-frame.html#chap-data-frame"><span class="std std-numref">Chapter 12</span></a>)
represents the results of an experimental study involving 60 guinea pigs.
The experiment’s aim was to measure the effect of different vitamin C
<code class="docutils literal notranslate"><span class="pre">supp</span></code>lement types and <code class="docutils literal notranslate"><span class="pre">dose</span></code>s on the growth of the rodents’ teeth <code class="docutils literal notranslate"><span class="pre">len</span></code>gths:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">ToothGrowth</span> <span class="o">&lt;-</span> <span class="nf">as.list</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="p">)</span>  <span class="c1"># it is a list, but with extra attribs</span>
<span class="n">ToothGrowth</span><span class="p">[[</span><span class="s">&quot;supp&quot;</span><span class="p">]]</span> <span class="o">&lt;-</span> <span class="nf">as.character</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="p">[[</span><span class="s">&quot;supp&quot;</span><span class="p">]])</span>  <span class="c1"># was: factor</span>
<span class="nf">print</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="p">)</span>
<span class="c1">## $len</span>
<span class="c1">##  [1]  4.2 11.5  7.3  5.8  6.4 10.0 11.2 11.2  5.2  7.0 16.5 16.5 15.2 17.3</span>
<span class="c1">## [15] 22.5 17.3 13.6 14.5 18.8 15.5 23.6 18.5 33.9 25.5 26.4 32.5 26.7 21.5</span>
<span class="c1">## [29] 23.3 29.5 15.2 21.5 17.6  9.7 14.5 10.0  8.2  9.4 16.5  9.7 19.7 23.3</span>
<span class="c1">## [43] 23.6 26.4 20.0 25.2 25.8 21.2 14.5 27.3 25.5 26.4 22.4 24.5 24.8 30.9</span>
<span class="c1">## [57] 26.4 27.3 29.4 23.0</span>
<span class="c1">## </span>
<span class="c1">## $supp</span>
<span class="c1">##  [1] &quot;VC&quot; &quot;VC&quot; &quot;VC&quot; &quot;VC&quot; &quot;VC&quot; &quot;VC&quot; &quot;VC&quot; &quot;VC&quot; &quot;VC&quot; &quot;VC&quot; &quot;VC&quot; &quot;VC&quot; &quot;VC&quot; &quot;VC&quot;</span>
<span class="c1">## [15] &quot;VC&quot; &quot;VC&quot; &quot;VC&quot; &quot;VC&quot; &quot;VC&quot; &quot;VC&quot; &quot;VC&quot; &quot;VC&quot; &quot;VC&quot; &quot;VC&quot; &quot;VC&quot; &quot;VC&quot; &quot;VC&quot; &quot;VC&quot;</span>
<span class="c1">## [29] &quot;VC&quot; &quot;VC&quot; &quot;OJ&quot; &quot;OJ&quot; &quot;OJ&quot; &quot;OJ&quot; &quot;OJ&quot; &quot;OJ&quot; &quot;OJ&quot; &quot;OJ&quot; &quot;OJ&quot; &quot;OJ&quot; &quot;OJ&quot; &quot;OJ&quot;</span>
<span class="c1">## [43] &quot;OJ&quot; &quot;OJ&quot; &quot;OJ&quot; &quot;OJ&quot; &quot;OJ&quot; &quot;OJ&quot; &quot;OJ&quot; &quot;OJ&quot; &quot;OJ&quot; &quot;OJ&quot; &quot;OJ&quot; &quot;OJ&quot; &quot;OJ&quot; &quot;OJ&quot;</span>
<span class="c1">## [57] &quot;OJ&quot; &quot;OJ&quot; &quot;OJ&quot; &quot;OJ&quot;</span>
<span class="c1">## </span>
<span class="c1">## $dose</span>
<span class="c1">##  [1] 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 1.0 1.0 1.0 1.0 1.0 1.0 1.0</span>
<span class="c1">## [18] 1.0 1.0 1.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 0.5 0.5 0.5 0.5</span>
<span class="c1">## [35] 0.5 0.5 0.5 0.5 0.5 0.5 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 2.0</span>
<span class="c1">## [52] 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0</span>
</pre></div>
</div>
<p>We can split <code class="docutils literal notranslate"><span class="pre">len</span></code> with respect to the combinations of <code class="docutils literal notranslate"><span class="pre">supp</span></code> and <code class="docutils literal notranslate"><span class="pre">dose</span></code>
(also called <em>interactions</em>) by calling:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">split</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="p">[[</span><span class="s">&quot;len&quot;</span><span class="p">]],</span> <span class="n">ToothGrowth</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;supp&quot;</span><span class="p">,</span> <span class="s">&quot;dose&quot;</span><span class="p">)],</span> <span class="n">sep</span><span class="o">=</span><span class="s">&quot;_&quot;</span><span class="p">)</span>
<span class="c1">## $OJ_0.5</span>
<span class="c1">##  [1] 15.2 21.5 17.6  9.7 14.5 10.0  8.2  9.4 16.5  9.7</span>
<span class="c1">## </span>
<span class="c1">## $VC_0.5</span>
<span class="c1">##  [1]  4.2 11.5  7.3  5.8  6.4 10.0 11.2 11.2  5.2  7.0</span>
<span class="c1">## </span>
<span class="c1">## $OJ_1</span>
<span class="c1">##  [1] 19.7 23.3 23.6 26.4 20.0 25.2 25.8 21.2 14.5 27.3</span>
<span class="c1">## </span>
<span class="c1">## $VC_1</span>
<span class="c1">##  [1] 16.5 16.5 15.2 17.3 22.5 17.3 13.6 14.5 18.8 15.5</span>
<span class="c1">## </span>
<span class="c1">## $OJ_2</span>
<span class="c1">##  [1] 25.5 26.4 22.4 24.5 24.8 30.9 26.4 27.3 29.4 23.0</span>
<span class="c1">## </span>
<span class="c1">## $VC_2</span>
<span class="c1">##  [1] 23.6 18.5 33.9 25.5 26.4 32.5 26.7 21.5 23.3 29.5</span>
</pre></div>
</div>
<p>Other synonyms are of course possible, e.g.,
<strong class="command">split</strong><code class="code docutils literal notranslate"><span class="pre">(ToothGrowth[[1]],</span> <span class="pre">ToothGrowth[-1])</span></code>,
<strong class="command">split</strong><code class="code docutils literal notranslate"><span class="pre">(ToothGrowth[[1]],</span> </code><strong class="command">list</strong><code class="code docutils literal notranslate"><span class="pre">(ToothGrowth[[2]],</span> <span class="pre">ToothGrowth[[3]]))</span></code>,
etc. However, we should meditate upon our conscious use of double vs single
square brackets here.</p>
<p>Functions such as <strong class="command">Map</strong> described in <a class="reference internal" href="170-function.html#sec-fun-prog"><span class="std std-numref">Section 7.2</span></a>
will enable us to compute any summary statistics within groups
(e.g., the within-group averages like with
“<code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">AVG(len)</span> <span class="pre">FROM</span> <span class="pre">ToothGrowth</span> <span class="pre">GROUP</span> <span class="pre">BY</span> <span class="pre">supp,</span> <span class="pre">dose</span></code>”
in SQL). We are in no hurry. However, as an appetiser,
let us feed the <strong class="command">boxplot</strong> function
with a list of vectors; see <a class="reference internal" href="#fig-toothgrowth-boxplot"><span class="std std-numref">Figure 5.1</span></a>.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">boxplot</span><span class="p">(</span><span class="nf">split</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="p">[[</span><span class="s">&quot;len&quot;</span><span class="p">]],</span> <span class="n">ToothGrowth</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;supp&quot;</span><span class="p">,</span> <span class="s">&quot;dose&quot;</span><span class="p">)],</span> <span class="n">sep</span><span class="o">=</span><span class="s">&quot;_&quot;</span><span class="p">))</span>
</pre></div>
</div>
<figure class="align-default" id="id18">
<span id="fig-toothgrowth-boxplot"></span><img alt="../_images/toothgrowth-boxplot-1.png" src="../_images/toothgrowth-boxplot-1.png" />
<figcaption>
<p><span class="caption-number">Figure 5.1 </span><span class="caption-text">Box-and-whisker plots of <code class="docutils literal notranslate"><span class="pre">len</span></code> split by <code class="docutils literal notranslate"><span class="pre">supp</span></code> and <code class="docutils literal notranslate"><span class="pre">dose</span></code> (the <code class="docutils literal notranslate"><span class="pre">ToothGrowth</span></code> dataset)</span><a class="headerlink" href="#id18" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</div></div><div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong class="command">unsplit</strong> can be used to revoke the effects of <strong class="command">split</strong>.
In particular, later  we will get used to calling
<strong class="command">unsplit</strong><code class="code docutils literal notranslate"><span class="pre">(</span></code><strong class="command">Map</strong><code class="code docutils literal notranslate"><span class="pre">(</span></code><strong class="command">some_transformation</strong><code class="code docutils literal notranslate"><span class="pre">,</span> </code><strong class="command">split</strong><code class="code docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">z)),</span> <span class="pre">z)</span></code>
to modify the values in <code class="docutils literal notranslate"><span class="pre">x</span></code> independently in each group defined by <code class="docutils literal notranslate"><span class="pre">z</span></code>
(e.g., standardise the variables within each class separately).</p>
</div>
</section>
<section id="ordering-elements">
<span id="sec-order"></span><h3><span class="section-number">5.4.4. </span>Ordering Elements<a class="headerlink" href="#ordering-elements" title="Permalink to this heading"></a></h3>
<p>The <strong class="command">order</strong> function finds the ordering permutation of a given
vector, i.e., a sequence of indexes which leads to a sorted version thereof.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">1024</span><span class="p">,</span> <span class="m">7</span><span class="p">,</span> <span class="m">42</span><span class="p">,</span> <span class="m">666</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">32787</span><span class="p">)</span>
<span class="p">(</span><span class="n">o</span> <span class="o">&lt;-</span> <span class="nf">order</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>  <span class="c1"># the ordering permutation of x</span>
<span class="c1">## [1] 5 2 3 4 1 6</span>
<span class="n">x</span><span class="p">[</span><span class="n">o</span><span class="p">]</span>  <span class="c1"># ordered version of x</span>
<span class="c1">## [1]     0     7    42   666  1024 32787</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">o[1]</span></code> is the index of the smallest element in <code class="docutils literal notranslate"><span class="pre">x</span></code>,
<code class="docutils literal notranslate"><span class="pre">o[2]</span></code> is the position of the 2nd smallest, …, and <code class="code docutils literal notranslate"><span class="pre">o[</span></code><strong class="command">length</strong><code class="code docutils literal notranslate"><span class="pre">(o)]</span></code>
is the index of the greatest value.
Hence, e.g., <code class="docutils literal notranslate"><span class="pre">x[o[1]]</span></code> is equivalent to <strong class="command">min</strong><code class="code docutils literal notranslate"><span class="pre">(x)</span></code>.</p>
<p>Another example:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;abs&quot;</span><span class="p">,</span> <span class="s">&quot;bass&quot;</span><span class="p">,</span> <span class="s">&quot;aaargh&quot;</span><span class="p">,</span> <span class="s">&quot;aargh&quot;</span><span class="p">,</span> <span class="s">&quot;aaaargh&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="n">o</span> <span class="o">&lt;-</span> <span class="nf">order</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="c1">## [1] 2 7 5 6 3 1 4</span>
<span class="n">x</span><span class="p">[</span><span class="n">o</span><span class="p">]</span>
<span class="c1">## [1] &quot;a&quot;       &quot;aaaargh&quot; &quot;aaargh&quot;  &quot;aargh&quot;   &quot;abs&quot;     &quot;b&quot;       &quot;bass&quot;</span>
</pre></div>
</div>
<p>Here, as <code class="docutils literal notranslate"><span class="pre">x</span></code> is a character vector, the ordering is lexicographical
(like in a dictionary), because this is exactly how
`<strong class="command">&lt;=</strong>` on strings works.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The ordering permutation that <strong class="command">order</strong> returns is unique
(that is why we call it <em>the</em> permutation) even
for inputs containing duplicated elements.
Owing to the use of a <em>stable</em> sorting algorithm, ties (repeated elements)
will be listed in the order of occurrence.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">order</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">20</span><span class="p">,</span> <span class="m">40</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">30</span><span class="p">,</span> <span class="m">20</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">10</span><span class="p">))</span>
<span class="c1">## [1] 1 4 5 8 9 2 7 6 3</span>
</pre></div>
</div>
<p>Above we have, e.g., five 10s at positions 1, 4, 5, 6, 9.
These five indexes are guaranteed to be listed in this very order.</p>
</div>
<p>Ordering can also be performed in a nonincreasing manner:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">decreasing</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)]</span>
<span class="c1">## [1] &quot;bass&quot;    &quot;b&quot;       &quot;abs&quot;     &quot;aargh&quot;   &quot;aaargh&quot;  &quot;aaaargh&quot; &quot;a&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A call to <strong class="command">sort</strong><code class="code docutils literal notranslate"><span class="pre">(x)</span></code> is equivalent
to <code class="docutils literal notranslate"><span class="pre">x[</span></code><strong class="command">order</strong><code class="code docutils literal notranslate"><span class="pre">(x)]</span></code>, but
the former function can be faster in some scenarios.
For instance, one of its arguments can induce a <em>partially</em>
sorted vector which can be useful if we only seek a few
order statistics (e.g., the seven smallest values).
Speed is rarely a bottleneck in the case of sorting
(when it is, we have a problem!), this is why we will not bother ourselves
with such topics until the last part of this pleasant book.
Currently, we aim at expanding our repertoire of skills and abilities,
so that we can implement anything we can think of (rapid prototyping
with the least footprint).</p>
</div>
<div class="proof proof-type-exercise" id="id19">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.11</span>
        
    </div><div class="proof-content">
<p><strong class="command">is.unsorted</strong><code class="code docutils literal notranslate"><span class="pre">(x)</span></code> can be used to determine if the elements
in a given vector are… <em>not</em> sorted with respect to `<strong class="command">&lt;=</strong>`.
Write an R expression that generates the same result by referring
to the <strong class="command">order</strong> function. Also, assuming that <code class="docutils literal notranslate"><span class="pre">x</span></code> is numeric,
do the same by means of a call to <strong class="command">diff</strong>.</p>
</div></div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Looking at <strong class="command">help</strong><code class="code docutils literal notranslate"><span class="pre">(&quot;order&quot;)</span></code>, we see that it also accepts
one or more arguments via the dot-dot-dot parameter, “<code class="docutils literal notranslate"><span class="pre">...</span></code>”.
This way, we can sort a vector with respect to many criteria.
If there are ties (equal observations) in the first variable,
they will be resolved by the order of elements in the second variable.
This is most useful for rearranging the rows of a data frame,
which we will exercise in  <a class="reference internal" href="240-data-frame.html#chap-data-frame"><span class="std std-numref">Chapter 12</span></a>.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span>  <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span> <span class="m">10</span><span class="p">,</span>  <span class="m">20</span><span class="p">,</span>  <span class="m">30</span><span class="p">,</span>  <span class="m">40</span><span class="p">,</span>  <span class="m">50</span><span class="p">,</span>  <span class="m">60</span><span class="p">)</span>
<span class="n">y1</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;w&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">,</span> <span class="s">&quot;v&quot;</span><span class="p">,</span> <span class="s">&quot;u&quot;</span><span class="p">,</span> <span class="s">&quot;u&quot;</span><span class="p">,</span> <span class="s">&quot;v&quot;</span><span class="p">)</span>
<span class="n">x</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">y1</span><span class="p">)]</span>
<span class="c1">## [1] 10 30 40 20 50 60</span>
<span class="n">x</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">y2</span><span class="p">)]</span>
<span class="c1">## [1] 40 50 30 60 10 20</span>
<span class="n">x</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">)]</span>
<span class="c1">## [1] 40 30 10 50 60 20</span>
<span class="n">x</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">y2</span><span class="p">,</span> <span class="n">y1</span><span class="p">)]</span>
<span class="c1">## [1] 40 50 30 60 10 20</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>(*)
Calling <strong class="command">order</strong> on a permutation
(a vector that is an arbitrary arrangement of <em>n</em> consecutive
natural numbers) determines its <em>inverse</em>.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">30</span><span class="p">,</span> <span class="m">40</span><span class="p">,</span> <span class="m">20</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">50</span><span class="p">,</span> <span class="m">30</span><span class="p">)</span>
<span class="nf">order</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1">## [1] 1 5 6 4 2 8 3 7</span>
<span class="nf">order</span><span class="p">(</span><span class="nf">order</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>  <span class="c1"># inverse of the above permutation</span>
<span class="c1">## [1] 1 5 7 4 2 3 8 6</span>
<span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">x</span><span class="p">)])[</span><span class="nf">order</span><span class="p">(</span><span class="nf">order</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>  <span class="c1"># we get x again</span>
<span class="c1">## [1] 10 30 40 20 10 10 50 30</span>
</pre></div>
</div>
<p>Note that <strong class="command">order</strong><code class="code docutils literal notranslate"><span class="pre">(</span></code><strong class="command">order</strong><code class="code docutils literal notranslate"><span class="pre">(x))</span></code>
can be considered as
a way to <em>rank</em> all the elements in <code class="docutils literal notranslate"><span class="pre">x</span></code>.
For instance, the 3rd value in <code class="docutils literal notranslate"><span class="pre">x</span></code>, 40, is assigned rank 7: it is
the 7th smallest value in this vector.
Note that this breaks the ties at a first-come-first-served basis.
But we can also write:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">order</span><span class="p">(</span><span class="nf">order</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nf">runif</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">x</span><span class="p">))))</span>  <span class="c1"># ranks with ties broken at random</span>
<span class="c1">## [1] 2 5 7 4 3 1 8 6</span>
</pre></div>
</div>
<p>For different variations of these, see the <strong class="command">rank</strong> function.</p>
</div>
<div class="proof proof-type-exercise" id="id20">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.12</span>
        
    </div><div class="proof-content">
<p>Recall that <strong class="command">sample</strong><code class="code docutils literal notranslate"><span class="pre">(x)</span></code> returns
a pseudorandom permutation of elements of a given vector
unless <code class="docutils literal notranslate"><span class="pre">x</span></code> is a single positive number.
Write an expression that always yields a proper rearrangement,
regardless of the size of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</div></div></section>
<section id="identifying-duplicates">
<h3><span class="section-number">5.4.5. </span>Identifying Duplicates<a class="headerlink" href="#identifying-duplicates" title="Permalink to this heading"></a></h3>
<p>Whether any element in a vector was already listed in the sequence,
can be verified by calling:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">20</span><span class="p">,</span> <span class="m">30</span><span class="p">,</span> <span class="m">20</span><span class="p">,</span> <span class="m">40</span><span class="p">,</span> <span class="m">50</span><span class="p">,</span> <span class="m">50</span><span class="p">,</span> <span class="m">50</span><span class="p">,</span> <span class="m">20</span><span class="p">,</span> <span class="m">20</span><span class="p">,</span> <span class="m">60</span><span class="p">)</span>
<span class="nf">duplicated</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1">##  [1] FALSE FALSE FALSE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE</span>
</pre></div>
</div>
<p>This can be used to remove repeated observations; see also
<strong class="command">unique</strong>. Note that the value that this function returns is not
guaranteed to be sorted (unlike in some other languages/libraries).</p>
<div class="proof proof-type-exercise" id="id21">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.13</span>
        
    </div><div class="proof-content">
<p>What can be the use case of a call to <strong class="command">match</strong><code class="code docutils literal notranslate"><span class="pre">(x,</span> </code><strong class="command">unique</strong><code class="code docutils literal notranslate"><span class="pre">(x))</span></code>?</p>
</div></div><div class="proof proof-type-exercise" id="id22">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.14</span>
        
    </div><div class="proof-content">
<p>Given two named lists <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> which we treat
as key-value pairs, determine their set-theoretic union (with respect
to the keys), for example:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">list</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
<span class="n">y</span> <span class="o">&lt;-</span> <span class="nf">list</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="m">3</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="m">4</span><span class="p">)</span>
<span class="n">z</span> <span class="o">&lt;-</span> <span class="n">...to.do...</span>  <span class="c1"># combine x and y</span>
<span class="nf">str</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="c1">## List of 3</span>
<span class="c1">##  $ a: num 4</span>
<span class="c1">##  $ b: num 2</span>
<span class="c1">##  $ c: num 3</span>
</pre></div>
</div>
</div></div></section>
<section id="counting-index-occurrences">
<h3><span class="section-number">5.4.6. </span>Counting Index Occurrences<a class="headerlink" href="#counting-index-occurrences" title="Permalink to this heading"></a></h3>
<p><strong class="command">tabulate</strong> takes a vector of values from a set of small
positive integers (e.g., indexes) and determines their
number of occurrences:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
<span class="nf">tabulate</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1">## [1] 0 4 2 1 0 3</span>
</pre></div>
</div>
<p>In other words, there are 0 ones, 4 twos, …, and 3 sixes.</p>
<div class="proof proof-type-exercise" id="id23">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.15</span>
        
    </div><div class="proof-content">
<p>Using a call to <strong class="command">tabulate</strong> (amongst others), return a named
vector with the number of occurrences of each unique element in a character
vector. For example:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;d&quot;</span><span class="p">,</span> <span class="s">&quot;e&quot;</span><span class="p">,</span> <span class="s">&quot;e&quot;</span><span class="p">,</span> <span class="s">&quot;g&quot;</span><span class="p">,</span> <span class="s">&quot;g&quot;</span><span class="p">,</span> <span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="s">&quot;g&quot;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">&lt;-</span> <span class="n">...to.do...</span>
<span class="nf">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="c1">## a b c d e g </span>
<span class="c1">## 3 1 3 1 2 3</span>
</pre></div>
</div>
</div></div></section>
</section>
<section id="preserving-and-losing-attributes">
<span id="sec-attrpreserv"></span><h2><span class="section-number">5.5. </span>Preserving and Losing Attributes<a class="headerlink" href="#preserving-and-losing-attributes" title="Permalink to this heading"></a></h2>
<p>As attributes are conceived as extra data, it is up to a function’s
authors what they will decide to do with them.
Generally, it is safe to assume that much thought has been put into
the design of base R functions. Oftentimes, they behave quite reasonably.
This is why we are going to spend some time now exploring
their approaches to the handling of attributes.</p>
<p>Namely, for functions and operators that aim at transforming
vectors passed as their inputs, the assumed strategy may be to:</p>
<ul class="simple">
<li><p>ignore the input attributes completely,</p></li>
<li><p>equip the output object with the same set of attributes, or</p></li>
<li><p>take care only of some special attributes such as <code class="docutils literal notranslate"><span class="pre">names</span></code>,
if that makes sense.</p></li>
</ul>
<p>Below we explore some common patterns; see also Section 1.3
in <span id="id6">[<a class="reference internal" href="999-bibliography.html#id10" title="R Development Core Team. (2023).  R Internals. URL: https://CRAN.R-project.org/doc/manuals/r-release/R-ints.html.">48</a>]</span>.</p>
<section id="c">
<h3><span class="section-number">5.5.1. </span><strong class="command">c</strong><a class="headerlink" href="#c" title="Permalink to this heading"></a></h3>
<p>First, <strong class="command">c</strong> drops<a class="footnote-reference brackets" href="#footcdrop" id="id7">5</a> all
attributes except <code class="docutils literal notranslate"><span class="pre">names</span></code>:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">structure</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="s">&quot;d&quot;</span><span class="p">),</span> <span class="n">attrib1</span><span class="o">=</span><span class="s">&quot;&lt;3&quot;</span><span class="p">))</span>
<span class="c1">## a b c d </span>
<span class="c1">## 1 2 3 4 </span>
<span class="c1">## attr(,&quot;attrib1&quot;)</span>
<span class="c1">## [1] &quot;&lt;3&quot;</span>
<span class="nf">c</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># only `names` are preserved</span>
<span class="c1">## a b c d </span>
<span class="c1">## 1 2 3 4</span>
</pre></div>
</div>
<p>We can therefore end up calling this function chiefly for this nice
side effect. Also recall that <strong class="command">unname</strong> drops the labels.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">unname</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1">## [1] 1 2 3 4</span>
<span class="c1">## attr(,&quot;attrib1&quot;)</span>
<span class="c1">## [1] &quot;&lt;3&quot;</span>
</pre></div>
</div>
</section>
<section id="as-something">
<h3><span class="section-number">5.5.2. </span><strong class="command">as.something</strong><a class="headerlink" href="#as-something" title="Permalink to this heading"></a></h3>
<p><strong class="command">as.vector</strong>, <strong class="command">as.numeric</strong>, and similar drop all attributes
in the case where the output is an atomic vector,
but it might not necessarily do so in other cases
(because they are S3 generics; see <a class="reference internal" href="220-s3.html#chap-s3"><span class="std std-numref">Chapter 10</span></a>).</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">as.vector</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># drops all attributes if x is atomic</span>
<span class="c1">## [1] 1 2 3 4</span>
</pre></div>
</div>
</section>
<section id="subsetting">
<h3><span class="section-number">5.5.3. </span>Subsetting<a class="headerlink" href="#subsetting" title="Permalink to this heading"></a></h3>
<p>Subsetting with `<strong class="command">[</strong>` (except where the indexer is not given)
drops all attributes but <code class="docutils literal notranslate"><span class="pre">names</span></code> (as well as <code class="docutils literal notranslate"><span class="pre">dim</span></code> and <code class="docutils literal notranslate"><span class="pre">dimnames</span></code>;
see <a class="reference internal" href="230-matrix.html#chap-matrix"><span class="std std-numref">Chapter 11</span></a>), which is adjusted accordingly:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="m">1</span><span class="p">]</span>    <span class="c1"># subset of labels</span>
<span class="c1">## a </span>
<span class="c1">## 1</span>
<span class="n">x</span><span class="p">[[</span><span class="m">1</span><span class="p">]]</span>  <span class="c1"># this always drops the labels</span>
<span class="c1">## [1] 1</span>
</pre></div>
</div>
<p>The replacement version of the index operator
can be used to modify the values in an existing
vector whilst preserving all the attributes.
In particular, skipping the indexer will allow us to replace
all the elements:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">&lt;-</span> <span class="n">x</span>
<span class="n">y</span><span class="p">[]</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;u&quot;</span><span class="p">,</span> <span class="s">&quot;v&quot;</span><span class="p">)</span>  <span class="c1"># note that c(&quot;u&quot;, &quot;v&quot;) has no attributes at all</span>
<span class="nf">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="c1">##   a   b   c   d </span>
<span class="c1">## &quot;u&quot; &quot;v&quot; &quot;u&quot; &quot;v&quot; </span>
<span class="c1">## attr(,&quot;attrib1&quot;)</span>
<span class="c1">## [1] &quot;&lt;3&quot;</span>
</pre></div>
</div>
</section>
<section id="vectorised-functions">
<h3><span class="section-number">5.5.4. </span>Vectorised Functions<a class="headerlink" href="#vectorised-functions" title="Permalink to this heading"></a></h3>
<p>Vectorised unary functions tend to copy all the attributes.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">round</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1">## a b c d </span>
<span class="c1">## 1 2 3 4 </span>
<span class="c1">## attr(,&quot;attrib1&quot;)</span>
<span class="c1">## [1] &quot;&lt;3&quot;</span>
</pre></div>
</div>
<p>Binary operations should get the attributes from the longer
input or both (with the first argument preferred to the second)
if they are of equal sizes.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">&lt;-</span> <span class="nf">structure</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">10</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;f&quot;</span><span class="p">,</span> <span class="s">&quot;g&quot;</span><span class="p">),</span> <span class="n">attrib1</span><span class="o">=</span><span class="s">&quot;:|&quot;</span><span class="p">,</span> <span class="n">attrib2</span><span class="o">=</span><span class="s">&quot;:O&quot;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">*</span> <span class="n">x</span>  <span class="c1"># x is longer</span>
<span class="c1">##  a  b  c  d </span>
<span class="c1">##  1 20  3 40 </span>
<span class="c1">## attr(,&quot;attrib1&quot;)</span>
<span class="c1">## [1] &quot;&lt;3&quot;</span>
<span class="n">y</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;h&quot;</span><span class="p">,</span> <span class="s">&quot;i&quot;</span><span class="p">)]</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">100</span><span class="p">,</span> <span class="m">1000</span><span class="p">)</span>  <span class="c1"># add two new elements at the end</span>
<span class="n">y</span> <span class="o">*</span> <span class="n">x</span>
<span class="c1">##    f    g    h    i </span>
<span class="c1">##    1   20  300 4000 </span>
<span class="c1">## attr(,&quot;attrib1&quot;)</span>
<span class="c1">## [1] &quot;:|&quot;</span>
<span class="c1">## attr(,&quot;attrib2&quot;)</span>
<span class="c1">## [1] &quot;:O&quot;</span>
<span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
<span class="c1">##    a    b    c    d </span>
<span class="c1">##    1   20  300 4000 </span>
<span class="c1">## attr(,&quot;attrib1&quot;)</span>
<span class="c1">## [1] &quot;&lt;3&quot;</span>
<span class="c1">## attr(,&quot;attrib2&quot;)</span>
<span class="c1">## [1] &quot;:O&quot;</span>
</pre></div>
</div>
<p>Also, refer to <a class="reference internal" href="210-design.html#sec-replacementfun"><span class="std std-numref">Section 9.4.5</span></a> for a way
to copy all the attributes from one object to another.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Even in base R the above rules are not enforced strictly.
We consider them bugs that should be, for the time being, treated as features
(with which we need to learn to live
as they have not been fixed for years). But there is still hope.</p>
<p>As far as third-party extension packages are concerned,
suffice it to say that a lot of R programmers do not know
what attributes are at all! It is always best to refer to the documentation,
perform some experiments,
and/or manually assure the preservation of the data we care about.</p>
</div>
</section>
</section>
<section id="exercises">
<h2><span class="section-number">5.6. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading"></a></h2>
<div class="proof proof-type-exercise" id="id24">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.16</span>
        
    </div><div class="proof-content">
<p>Answer the following questions (contemplate first, then
use R to find the answer):</p>
<ul class="simple">
<li><p>What is the result of “<code class="docutils literal notranslate"><span class="pre">x[</span></code><strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">()]</span></code>?”
Is it the same as “<code class="docutils literal notranslate"><span class="pre">x[]</span></code>”?</p></li>
<li><p>Is “<code class="docutils literal notranslate"><span class="pre">x[</span></code><strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)]</span></code>” equivalent to “<code class="docutils literal notranslate"><span class="pre">x[1]</span></code>”?</p></li>
<li><p>Is “<code class="docutils literal notranslate"><span class="pre">x[1]</span></code>” equivalent to “<code class="docutils literal notranslate"><span class="pre">x[&quot;1&quot;]</span></code>”?</p></li>
<li><p>Is “<code class="docutils literal notranslate"><span class="pre">x[</span></code><strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">(-1,</span> <span class="pre">-1,</span> <span class="pre">-1)]</span></code>” equivalent to “<code class="docutils literal notranslate"><span class="pre">x[-1]</span></code>”?</p></li>
<li><p>What does “<code class="docutils literal notranslate"><span class="pre">x[</span></code><strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">NA)]</span></code>” do?</p></li>
<li><p>What does “<code class="docutils literal notranslate"><span class="pre">x[0]</span></code>” return?</p></li>
<li><p>What does “<code class="docutils literal notranslate"><span class="pre">x[1,</span> <span class="pre">2,</span> <span class="pre">3]</span></code>” do?</p></li>
<li><p>What about “<code class="docutils literal notranslate"><span class="pre">x[</span></code><strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">-1,</span> <span class="pre">-2)]</span></code>”
and “<code class="docutils literal notranslate"><span class="pre">x[</span></code><strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">(-1,</span> <span class="pre">-2,</span> <span class="pre">NA)]</span></code>”?</p></li>
<li><p>Why “<code class="docutils literal notranslate"><span class="pre">x[NA]</span></code>” is so significantly different
from “<code class="docutils literal notranslate"><span class="pre">x[</span></code><strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">NA)]</span></code>”?</p></li>
<li><p>What is “<code class="docutils literal notranslate"><span class="pre">x[</span></code><strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">(FALSE,</span> <span class="pre">TRUE,</span> <span class="pre">2)]</span></code>”?</p></li>
<li><p>What will we obtain by calling “<code class="docutils literal notranslate"><span class="pre">x[x&lt;</span></code><strong class="command">min</strong><code class="code docutils literal notranslate"><span class="pre">(x)]</span></code>”?</p></li>
<li><p>What about “<code class="docutils literal notranslate"><span class="pre">x[</span></code><strong class="command">length</strong><code class="code docutils literal notranslate"><span class="pre">(x)+1]</span></code>”?</p></li>
<li><p>Why “<code class="docutils literal notranslate"><span class="pre">x[</span></code><strong class="command">min</strong><code class="code docutils literal notranslate"><span class="pre">(y)]</span></code>”
is probably a mistake? What could it mean? How can it be fixed?</p></li>
<li><p>Why cannot we mix indexes of different types
and write “<code class="docutils literal notranslate"><span class="pre">x[</span></code><strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">&quot;b&quot;,</span> <span class="pre">&quot;c&quot;,</span> <span class="pre">4)]</span></code>”? Or can we?</p></li>
<li><p>Why would we call
“<strong class="command">as.vector</strong><code class="code docutils literal notranslate"><span class="pre">(</span></code><strong class="command">na.omit</strong><code class="code docutils literal notranslate"><span class="pre">(x))</span></code>” instead
of just <strong class="command">na.omit</strong><code class="code docutils literal notranslate"><span class="pre">(x)</span></code>?</p></li>
<li><p>What is the difference between <strong class="command">sort</strong> and <strong class="command">order</strong>?</p></li>
<li><p>What is the type and the length of the object returned
by a call to “<strong class="command">split</strong><code class="code docutils literal notranslate"><span class="pre">(a,</span> <span class="pre">u)</span></code>”? What about
“<strong class="command">split</strong><code class="code docutils literal notranslate"><span class="pre">(a,</span> </code><strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">(u,</span> <span class="pre">v))</span></code>”?</p></li>
<li><p>How to get rid of the 7th element from a list of ten elements?</p></li>
<li><p>How to get rid of the 7th, 8th, and 9th element from a list of ten elements?</p></li>
<li><p>How to get rid of the 7th element from an atomic vector of ten elements?</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">y</span></code> is a list, by how many elements
“<code class="docutils literal notranslate"><span class="pre">y[</span></code><strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">(</span></code><strong class="command">length</strong><code class="code docutils literal notranslate"><span class="pre">(y)+1,</span> </code><strong class="command">length(y)</strong><code class="code docutils literal notranslate"><span class="pre">+1,</span> </code><strong class="command">length</strong><code class="code docutils literal notranslate"><span class="pre">(y)+1)]</span> <span class="pre">&lt;-</span> </code><strong class="command">list</strong><code class="code docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">2,</span> <span class="pre">3)</span></code>” will extend it?</p></li>
</ul>
</div></div><div class="proof proof-type-exercise" id="id25">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.17</span>
        
    </div><div class="proof-content">
<p>If <code class="docutils literal notranslate"><span class="pre">x</span></code> is an atomic vector of length <code class="docutils literal notranslate"><span class="pre">n</span></code>, “<code class="docutils literal notranslate"><span class="pre">x[5:n]</span></code>” obviously
extracts everything from the 5th element to the end.
Does it though? Check what happens when <code class="docutils literal notranslate"><span class="pre">x</span></code> is of length less than five,
including 0. List different ways to correct this expression
so that it makes (some) sense in the case of shorter vectors.</p>
</div></div><div class="proof proof-type-exercise" id="id26">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.18</span>
        
    </div><div class="proof-content">
<p>Similarly, “<code class="docutils literal notranslate"><span class="pre">x[</span></code><strong class="command">length</strong><code class="code docutils literal notranslate"><span class="pre">(x)</span> <span class="pre">+</span> <span class="pre">1</span> <span class="pre">-</span> <span class="pre">5:1]</span></code>”
is supposed to return the last five elements in <code class="docutils literal notranslate"><span class="pre">x</span></code>. Propose a few
alternatives that are correct also for short <code class="docutils literal notranslate"><span class="pre">x</span></code>s.</p>
</div></div><div class="proof proof-type-exercise" id="id27">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.19</span>
        
    </div><div class="proof-content">
<p>Given a numeric vector, fetch its five largest elements.
Make sure the code works for vectors of length less than five.</p>
</div></div><div class="proof proof-type-exercise" id="id28">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.20</span>
        
    </div><div class="proof-content">
<p>We can compute a <em>trimmed</em> mean of some <code class="docutils literal notranslate"><span class="pre">x</span></code>
by setting the <code class="docutils literal notranslate"><span class="pre">trim</span></code> argument to the <strong class="command">mean</strong> function.
Compute a similar robust estimator of location – the <em>p</em>-winsorised mean,
<span class="math notranslate nohighlight">\(p\in[0, 0.5]\)</span> defined as the arithmetic mean of all elements
in <code class="docutils literal notranslate"><span class="pre">x</span></code> clipped to the <span class="math notranslate nohighlight">\([Q_p, Q_{1-p}]\)</span> interval,
where <span class="math notranslate nohighlight">\(Q_p\)</span> is the vector’s <em>p</em>-quantile;
see <strong class="command">quantile</strong>.
For example, if <code class="docutils literal notranslate"><span class="pre">x</span></code> is (8, 5, 2, 9, 7, 4, 6, 1, 3),
we have <span class="math notranslate nohighlight">\(Q_{0.25}=3\)</span> and <span class="math notranslate nohighlight">\(Q_{0.75}=7\)</span> and hence the <span class="math notranslate nohighlight">\(0.25\)</span>-winsorised mean
will be equal to the arithmetic mean of (7, 5, 3, 7, 7, 4, 6, 3, 3).</p>
</div></div><div class="proof proof-type-exercise" id="id29">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.21</span>
        
    </div><div class="proof-content">
<p>Let <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> be two vectors of the same length, <em>n</em>, and no ties.
Compute the Spearman rank correlation coefficient given by:</p>
<div class="math notranslate nohighlight">
\[
\varrho(\mathbf{x},\mathbf{y})
=
1-\frac{6 \sum_{i=1}^n d_i^2}{n (n^2-1)},
\]</div>
<p>where <span class="math notranslate nohighlight">\(d_i=r_i-s_i\)</span>, <span class="math notranslate nohighlight">\(i=1,\dots,n\)</span>,
and <span class="math notranslate nohighlight">\(r_i\)</span> and <span class="math notranslate nohighlight">\(s_i\)</span> denote the rank of <span class="math notranslate nohighlight">\(x_i\)</span> and <span class="math notranslate nohighlight">\(y_i\)</span>, respectively.
See also the built-in <strong class="command">cor</strong>.</p>
</div></div><div class="proof proof-type-exercise" id="id30">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.22</span>
        
    </div><div class="proof-content">
<p>(*)
Given two vectors <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> of the same length <em>n</em>,
a call to <strong class="command">approx</strong><code class="code docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y,</span> <span class="pre">...)</span></code> can be used to
interpolate linearly between
the points <span class="math notranslate nohighlight">\((x_1, y_1), (x_2, y_2), \dots, (x_n, y_n)\)</span>.
We can use it whenever we wish to generate new <span class="math notranslate nohighlight">\(y\)</span>s for previously
unobserved <span class="math notranslate nohighlight">\(x\)</span>s (somewhere “in-between” the data we already have).
Moreover, <strong class="command">spline</strong><code class="code docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y,</span> <span class="pre">...)</span></code> can perform a cubic spline interpolation, which is smoother; see <a class="reference internal" href="#fig-approx"><span class="std std-numref">Figure 5.2</span></a>.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span>  <span class="m">5</span><span class="p">,</span> <span class="m">7</span><span class="p">,</span> <span class="m">10</span><span class="p">)</span>
<span class="n">y</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">15</span><span class="p">,</span> <span class="m">25</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span>  <span class="m">0</span><span class="p">)</span>
<span class="n">x_new</span> <span class="o">&lt;-</span> <span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="m">0.25</span><span class="p">)</span>
<span class="n">y_new1</span> <span class="o">&lt;-</span> <span class="nf">approx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xout</span><span class="o">=</span><span class="n">x_new</span><span class="p">)[[</span><span class="s">&quot;y&quot;</span><span class="p">]]</span>
<span class="n">y_new2</span> <span class="o">&lt;-</span> <span class="nf">spline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xout</span><span class="o">=</span><span class="n">x_new</span><span class="p">)[[</span><span class="s">&quot;y&quot;</span><span class="p">]]</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">-10</span><span class="p">,</span> <span class="m">30</span><span class="p">))</span>  <span class="c1"># the points to interpolate between</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">x_new</span><span class="p">,</span> <span class="n">y_new1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>   <span class="c1"># linear interpolation</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">x_new</span><span class="p">,</span> <span class="n">y_new2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span> <span class="n">lty</span><span class="o">=</span><span class="m">4</span><span class="p">)</span>  <span class="c1"># cubic interpolation</span>
</pre></div>
</div>
<figure class="align-default" id="id31">
<span id="fig-approx"></span><img alt="../_images/approx-1.png" src="../_images/approx-1.png" />
<figcaption>
<p><span class="caption-number">Figure 5.2 </span><span class="caption-text">Piecewise linear and cubic spline interpolation.</span><a class="headerlink" href="#id31" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>Using a call to one of the above,
perform the missing data imputation in the
<a class="reference external" href="https://github.com/gagolews/teaching-data/raw/master/marek/euraud-20200101-20200630.csv"><code class="docutils literal notranslate"><span class="pre">euraud-20200101-20200630.csv</span></code></a>,
e.g., the blanks in <code class="docutils literal notranslate"><span class="pre">(0.60,</span> <span class="pre">0.62,</span> <span class="pre">NA,</span> <span class="pre">0.64,</span> <span class="pre">NA,</span> <span class="pre">NA,</span> <span class="pre">0.58)</span></code> should
be filled so as to obtain <code class="docutils literal notranslate"><span class="pre">(0.60,</span> <span class="pre">0.62,</span> <span class="pre">0.63,</span> <span class="pre">0.64,</span> <span class="pre">0.62,</span> <span class="pre">0.60,</span> <span class="pre">0.58)</span></code>.</p>
</div></div><div class="proof proof-type-exercise" id="id32">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.23</span>
        
    </div><div class="proof-content">
<p>Given some <code class="docutils literal notranslate"><span class="pre">1</span></code> ≤ <code class="docutils literal notranslate"><span class="pre">from</span></code> ≤ <code class="docutils literal notranslate"><span class="pre">to</span></code> ≤ <code class="docutils literal notranslate"><span class="pre">n</span></code>, use <strong class="command">findInterval</strong>
to generate a logical vector of length <code class="docutils literal notranslate"><span class="pre">n</span></code>
with <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> elements only at indexes between <code class="docutils literal notranslate"><span class="pre">from</span></code> and <code class="docutils literal notranslate"><span class="pre">to</span></code>, inclusive.</p>
</div></div><div class="proof proof-type-exercise" id="id33">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.24</span>
        
    </div><div class="proof-content">
<p>Implement expressions that yield the same results
as calls to <strong class="command">which</strong>, <strong class="command">which.min</strong>,
<strong class="command">which.max</strong>, and <strong class="command">rev</strong> functions.
What is the difference between <code class="code docutils literal notranslate"><span class="pre">x[x&gt;y]</span></code> and
<code class="code docutils literal notranslate"><span class="pre">x[</span></code><strong class="command">which</strong><code class="code docutils literal notranslate"><span class="pre">(x&gt;y)]</span></code>?
What about <strong class="command">which.min</strong><code class="code docutils literal notranslate"><span class="pre">(x)</span></code> vs
<strong class="command">which</strong><code class="code docutils literal notranslate"><span class="pre">(x</span> <span class="pre">==</span> </code><strong class="command">min</strong><code class="code docutils literal notranslate"><span class="pre">(x))</span></code>?</p>
</div></div><div class="proof proof-type-exercise" id="id34">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.25</span>
        
    </div><div class="proof-content">
<p>Given two equal-length vectors <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>,
fetch the value from the former that corresponds
to the smallest value in the latter.
Write three versions of such an expression, each dealing with potential
ties in <code class="docutils literal notranslate"><span class="pre">y</span></code> differently, for example:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="s">&quot;d&quot;</span><span class="p">,</span> <span class="s">&quot;e&quot;</span><span class="p">,</span> <span class="s">&quot;f&quot;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span>  <span class="m">3</span><span class="p">,</span>   <span class="m">1</span><span class="p">,</span>   <span class="m">2</span><span class="p">,</span>   <span class="m">1</span><span class="p">,</span>   <span class="m">1</span><span class="p">,</span>   <span class="m">4</span><span class="p">)</span>
</pre></div>
</div>
<p>should choose either the first (<code class="docutils literal notranslate"><span class="pre">&quot;b&quot;</span></code>), last  (<code class="docutils literal notranslate"><span class="pre">&quot;e&quot;</span></code>), or random
(<code class="docutils literal notranslate"><span class="pre">&quot;b&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;d&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;e&quot;</span></code> with equal probability)
element from <code class="docutils literal notranslate"><span class="pre">x</span></code> fulfilling the above property.
Make sure your code works
for <code class="docutils literal notranslate"><span class="pre">x</span></code> being of type character or numeric as well as an empty vector.</p>
</div></div><div class="proof proof-type-exercise" id="id35">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.26</span>
        
    </div><div class="proof-content">
<p>Implement an expression that yields the same result as
<strong class="command">duplicated</strong><code class="code docutils literal notranslate"><span class="pre">(x)</span></code>
for a numeric vector <code class="docutils literal notranslate"><span class="pre">x</span></code>, but using <strong class="command">diff</strong> and <strong class="command">order</strong>.</p>
</div></div><div class="proof proof-type-exercise" id="id36">

    <div class="proof-title">
        <span class="proof-type">Exercise 5.27</span>
        
    </div><div class="proof-content">
<p>Based on <strong class="command">match</strong> and <strong class="command">unique</strong>,
implement your own versions of  <strong class="command">union</strong><code class="code docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code>,
<strong class="command">intersect</strong><code class="code docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code>, <strong class="command">setdiff</strong><code class="code docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code>,
<strong class="command">is.element</strong><code class="code docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code>, and <strong class="command">setequal</strong><code class="code docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code>
for <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> being non-empty numeric vectors.</p>
</div></div><hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="foothead"><span class="brackets"><a class="fn-backref" href="#id2">1</a></span></dt>
<dd><p><strong class="command">head</strong> and <strong class="command">tail</strong>
are actually S3 generics defined in the <strong class="program">utils</strong>
package.
We will be able to call them on matrices and data frames as
well; see <a class="reference internal" href="220-s3.html#chap-s3"><span class="std std-numref">Chapter 10</span></a>.</p>
</dd>
<dt class="label" id="footattraalmost"><span class="brackets"><a class="fn-backref" href="#id3">2</a></span></dt>
<dd><p>See also <a class="reference internal" href="#sec-attrpreserv"><span class="std std-numref">Section 5.5</span></a> for the discussion
on the preservation of object attributes.</p>
</dd>
<dt class="label" id="footperf"><span class="brackets"><a class="fn-backref" href="#id4">3</a></span></dt>
<dd><p>And often cheaply; see <a class="reference internal" href="180-flow.html#sec-time-complexity"><span class="std std-numref">Section 8.3.5</span></a> for
some performance notes.
Still, a warning can be generated on each size extension
if the <code class="docutils literal notranslate"><span class="pre">&quot;check.bounds&quot;</span></code> flag is set;
see <strong class="command">help</strong><code class="code docutils literal notranslate"><span class="pre">(&quot;options&quot;)</span></code>.</p>
</dd>
<dt class="label" id="footinname"><span class="brackets"><a class="fn-backref" href="#id5">4</a></span></dt>
<dd><p>A fantastic name; see <a class="reference internal" href="210-design.html#sec-operfun"><span class="std std-numref">Section 9.4.4</span></a>.</p>
</dd>
<dt class="label" id="footcdrop"><span class="brackets"><a class="fn-backref" href="#id7">5</a></span></dt>
<dd><p>To be precise, we mean the default S3 method of <strong class="command">c</strong>
here; compare <a class="reference internal" href="220-s3.html#sec-s3-direct-method-call"><span class="std std-numref">Section 10.2.4</span></a>.</p>
</dd>
</dl>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="160-character.html" class="btn btn-neutral float-right" title="6. Character Vectors" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="140-list.html" class="btn btn-neutral float-left" title="4. Lists and Attributes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        Copyright &#169; 2022–2023 by <a href="https://www.gagolewski.com">Marek Gagolewski</a>. Some rights reserved. Licensed under <a href='https://creativecommons.org/licenses/by-nc-nd/4.0/'>CC BY-NC-ND 4.0</a>.

    Built with <a href="https://sphinx-doc.org/">Sphinx</a>
    and a customised <a href="https://github.com/rtfd/sphinx_rtd_theme">rtd</a>
    theme.
      <span class="lastupdated">
        Last updated on 2023-01-01T15:24:00+1100.
      </span>


    This site will never display any ads: it is a non-profit project.
    It does not collect any data.

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>